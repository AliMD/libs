/*
 * AnythingSlider Video Controller 1.5 beta minified
 * for AnythingSlider v1.6+
 * By Rob Garrison (aka Mottie & Fudgey)
 * Dual licensed under the MIT and GPL licenses.
 */
;(function(d){d.fn.anythingSliderVideo=function(c){var a={videoId:"asvideo",wmode:"opaque",youtubeAutoLoad:!0,youtubeParams:{modestbranding:1,iv_load_policy:3,fs:1}};return this.each(function(){var b,e,h,g,f=d(this).data("AnythingSlider");if(f){b=f.video={};b.options=d.extend({},a,c);b.hasSwfo="undefined"!==typeof swfobject&&swfobject.hasOwnProperty("embedSWF")&&"function"===typeof swfobject.embedSWF&&swfobject.hasFlashPlayerVersion("1");b.list={};b.hasVid=!1;b.hasEmbed=!1;b.services=d.fn.anythingSliderVideo.services; b.hasEmbedCount=0;b.hasiframeCount=0;b.$items=f.$items.filter(":not(.cloned)");for(h in b.services)"string"===typeof h&&(g=b.services[h].selector,b.$items.find(g).each(function(){e=d(this);e.attr("id",b.options.videoId+d.fn.anythingSliderVideo.videoIndex);b.list[d.fn.anythingSliderVideo.videoIndex]={id:b.options.videoId+d.fn.anythingSliderVideo.videoIndex++,panel:e.closest(".panel")[0],service:h,selector:g,status:-1};b.hasVid=!0;g.match("embed|object")?(b.hasEmbed=!0,b.hasEmbedCount++):g.match("iframe")&& b.hasiframeCount++}));d.each(b.list,function(c,a){var l,e,h,g,m=d(a.panel).find(a.selector),j=b.services[a.service],p=j.api&&j.api.initParam||"",n=j.api&&j.api.playerId||"";b.hasEmbed&&b.hasSwfo&&a.selector.match("embed|object")?m.each(function(){l=d(this);e="OBJECT"===d(this).parent()[0].tagName?d(this).parent():d(this);h="EMBED"===e[0].tagName?e.attr("src"):e.find("embed").attr("src")||e.children().filter("[name=movie]").attr("value");g=d.extend(!0,{},{flashvars:null,params:{allowScriptAccess:"always", wmode:b.options.wmode||f.options.addWmodeToObject,allowfullscreen:!0},attr:{"class":e.attr("class"),style:e.attr("style"),"data-url":h}},j.embedOpts);e.wrap('<div id="'+a.id+'"></div>');swfobject.embedSWF(h+p+(n?n+a.id:""),a.id,e.attr("width"),e.attr("height"),"10",null,g.flashvars,g.params,g.attr,function(){j.hasOwnProperty("init")&&j.init(f,l,c);c>=b.hasEmbedCount&&f.$el.trigger("swf_completed",f)})}):a.selector.match("iframe")&&m.each(function(){var b=d(this);j.hasOwnProperty("init")&&j.init(f, b,c)})});b.gup=function(b,c){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=RegExp("[\\?&]"+b+"=([^&#]*)").exec(c||window.location.href);return null===a?"":a[1]};b.postMsg=function(b,c){var a=d("#"+c);a.length&&a[0].contentWindow.postMessage(b,a.attr("src").split("?")[0])};b.message=function(a){if(a.data&&!/infoDelivery/g.test(a.data)){var c=d.parseJSON(a.data);d.each(b.list,function(a){b.services[b.list[a].service].hasOwnProperty("message")&&b.services[b.list[a].service].message(f,c)})}}; b.control=function(a){var c,e=b.list,h="pause"===a?f.$lastPage[0]:f.$currentPage[0],g=!1;for(c=0;c<d.fn.anythingSliderVideo.videoIndex;c++)e[c].panel===h&&b.services[e[c].service].hasOwnProperty(a)&&(g=b.services[e[c].service][a](f,d("#"+e[c].id),c));return g};b.bindFrames=function(a){window.addEventListener?window.addEventListener(a,b.message,!1):window.attachEvent(/^on/.test(a)?a:"on"+a,b.message,!1)};b.hasiframeCount&&b.bindFrames("message");f.$el.bind("slide_init",function(){b.control("pause")}).bind("slide_complete", function(){b.control("cont")});b.isVideoPlayingOrig=f.options.isVideoPlaying;f.options.isVideoPlaying=function(){return b.control("isPlaying")||b.isVideoPlayingOrig&&b.isVideoPlayingOrig()};if("function"===typeof b.options.onVideoInitialized)b.options.onVideoInitialized(f)}})};d.fn.anythingSliderVideo.videoIndex=0;d.fn.anythingSliderVideo.services={video:{selector:"video",cont:function(c,a){c.options.resumeOnVisible&&(a.length&&a[0].paused&&0<a[0].currentTime&&!a[0].ended)&&a[0].play()},pause:function(){d("video").each(function(){"undefined"!== typeof this.pause&&this.pause()})},isPlaying:function(c,a){return a.length&&"undefined"!==typeof a[0].pause&&!a[0].paused&&!a[0].ended?!0:!1}},vimeo1:{selector:"iframe[src*=vimeo]",init:function(c,a){var b=a.attr("src");a.attr("src",function(d,h){return h+(b.match(/\?/g)?"":"?")+"&wmode="+(c.video.options.wmode||c.options.addWmodeToObject)+"&api=1&player_id="+a[0].id})},cont:function(c,a,b){c.options.resumeOnVisible&&"pause"===c.video.list[b].status&&c.video.postMsg('{"method":"play"}',a[0].id)}, pause:function(c){d("iframe[src*=vimeo]").each(function(){c.video.postMsg('{"method":"pause"}',this.id)})},message:function(c,a){var b,d=a.player_id||"";""!==d&&(b=d.replace(c.video.options.videoId,""),"ready"===a.event&&(c.video.postMsg('{"method":"addEventListener","value":"play"}',d),c.video.postMsg('{"method":"addEventListener","value":"pause"}',d),c.video.postMsg('{"method":"addEventListener","value":"finish"}',d)),c.video.list[b]&&(c.video.list[b].status=a.event))},isPlaying:function(c,a,b){return"play"=== c.video.list[b].status?!0:!1}},vimeo2:{selector:"object[data-url*=vimeo], embed[src*=vimeo]",embedOpts:{flashvars:{api:1}},cont:function(c,a){c.options.resumeOnVisible&&"function"===typeof a[0].api_play&&(a[0].api_paused()&&0!==a[0].api_getCurrentTime()&&2<a[0].api_getDuration()-a[0].api_getCurrentTime())&&a[0].api_play()},pause:function(){d("object[data-url*=vimeo], embed[src*=vimeo]").each(function(){var c="EMBED"===this.tagName?d(this).parent()[0]:this;"function"===typeof c.api_pause&&c.api_pause()})}, isPlaying:function(c,a){return"function"===typeof a[0].api_paused&&!a[0].api_paused()?!0:!1}},youtube1:{selector:"iframe[src*=youtube]",init:function(c,a,b){!d.fn.anythingSliderVideo.youTubeLoaded&&c.video.options.youtubeAutoLoad&&d.getScript("http://www.youtube.com/iframe_api",function(){d.fn.anythingSliderVideo.youTubeLoaded=!0});var e=0,h=setInterval(function(){if(d.fn.anythingSliderVideo.youTubeReady){var g=a[0].id,f=a.attr("src").split("embed/")[1],k=c.video.options.youtubeParams;k.wmode=c.video.options.wmode|| c.options.addWmodeToObject||"opaque";a.wrap('<div id="'+g+'"/>').attr("id","");c.video.list[b].player=new YT.Player(g,{height:"100%",width:"100%",videoId:f,playerVars:k,events:{onReady:function(a){c.video.list[b].status=a.data},onStateChange:function(a){c.video.list[b].status=a.data}}});clearInterval(h)}60<++e&&clearInterval(h)},1E3)},cont:function(c,a,b){c.options.resumeOnVisible&&2===c.video.list[b].status&&c.video.list[b].player&&c.video.list[b].player.playVideo()},pause:function(c,a,b){c.video.list[b].player&& c.video.list[b].player.pauseVideo()},isPlaying:function(c,a,b){c=c.video.list[b].status;return 1===c||2<c?!0:!1}},youtube2:{selector:"object[data-url*=youtube], embed[src*=youtube]",api:{initParam:"&enablejsapi=1",playerId:"&iv_load_policy=3&version=3&playerapiid="},cont:function(c,a){c.options.resumeOnVisible&&a.length&&("function"===typeof a[0].getPlayerState&&0<a[0].getPlayerState())&&a[0].playVideo()},pause:function(){d("object[data-url*=youtube], embed[src*=youtube]").each(function(){var c="EMBED"=== this.tagName?d(this).parent()[0]:this;"function"===typeof c.getPlayerState&&0<c.getPlayerState()&&c.pauseVideo()})},isPlaying:function(c,a){return"function"===typeof a[0].getPlayerState&&(1===a[0].getPlayerState()||2<a[0].getPlayerState())?!0:!1}}}})(jQuery);function onYouTubeIframeAPIReady(){$.fn.anythingSliderVideo.youTubeReady=!0};
