/*
 * jQuery spritely 0.6.5
 * http://spritely.net/
 *
 * Documentation:
 * http://spritely.net/documentation/
 *
 * Copyright 2010-2011, Peter Chater, Artlogic Media Ltd, http://www.artlogic.net/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 */
(function(a){a._spritely={animate:function(b){var c=a(b.el),d=c.attr("id");if(!a._spritely.instances[d])return this;if(b=a.extend(b,a._spritely.instances[d]||{}),b.play_frames&&!a._spritely.instances[d].remaining_frames&&(a._spritely.instances[d].remaining_frames=b.play_frames+1),"sprite"==b.type&&b.fps){var e,f=function(c){var f=b.width;if(b.height,!e){e=[],total=0;for(var h=0;b.no_of_frames>h;h++)e[e.length]=0-total,total+=f}0==a._spritely.instances[d].current_frame?b.on_first_frame&&b.on_first_frame(c):a._spritely.instances[d].current_frame==e.length-1&&b.on_last_frame&&b.on_last_frame(c),b.on_frame&&b.on_frame[a._spritely.instances[d].current_frame]&&b.on_frame[a._spritely.instances[d].current_frame](c),a._spritely.instances[d].current_frame=1==b.rewind?0>=a._spritely.instances[d].current_frame?e.length-1:a._spritely.instances[d].current_frame-1:a._spritely.instances[d].current_frame>=e.length-1?0:a._spritely.instances[d].current_frame+1;var i=a._spritely.getBgY(c);if(c.css("background-position",e[a._spritely.instances[d].current_frame]+"px "+i),b.bounce&&b.bounce[0]>0&&b.bounce[1]>0){var j=b.bounce[0],k=b.bounce[1],l=b.bounce[2];c.animate({top:"+="+j+"px",left:"-="+k+"px"},l).animate({top:"-="+j+"px",left:"+="+k+"px"},l)}};if(a._spritely.instances[d].remaining_frames&&a._spritely.instances[d].remaining_frames>0){if(a._spritely.instances[d].remaining_frames--,0==a._spritely.instances[d].remaining_frames)return a._spritely.instances[d].remaining_frames=-1,delete a._spritely.instances[d].remaining_frames,this;f(c)}else-1!=a._spritely.instances[d].remaining_frames&&f(c)}else if("pan"==b.type&&!a._spritely.instances[d]._stopped){var g=b.speed||1;switch(b.dir){case"up":g*=-1;case"down":a._spritely.instances[d].l||(a._spritely.instances[d].l=a._spritely.getBgX(c).replace("px","")),a._spritely.instances[d].t=a._spritely.instances[d].t+g||0,b.img_height&&(a._spritely.instances[d].t%=b.img_height);break;case"left":g*=-1;case"right":a._spritely.instances[d].t||(a._spritely.instances[d].t=a._spritely.getBgY(c).replace("px","")),a._spritely.instances[d].l=a._spritely.instances[d].l+g||0,b.img_width&&(a._spritely.instances[d].l%=b.img_width)}var h=""+a._spritely.instances[d].l;h+=-1==h.indexOf("%")?"px ":" ";var i=""+a._spritely.instances[d].t;i+=-1==i.indexOf("%")?"px ":" ",a(c).css("background-position",h+i)}a._spritely.instances[d].options=b,a._spritely.instances[d].timeout=window.setTimeout(function(){a._spritely.animate(b)},parseInt(1e3/b.fps))},randomIntBetween:function(a,b){return parseInt(rand_no=Math.floor((b-(a-1))*Math.random())+a)},getBgUseXY:function(){try{return"string"==typeof a("body").css("background-position-x")}catch(b){return!1}}(),getBgY:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-y")||"0":(a(b).css("background-position")||" ").split(" ")[1]},getBgX:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-x")||"0":(a(b).css("background-position")||" ").split(" ")[0]},get_rel_pos:function(a,b){var c=a;if(0>a)for(;0>c;)c+=b;else for(;c>b;)c-=b;return c},_spStrip:function(a,b){for(;a.length;){var c,d,e=!1,f=!1;for(c=0;b.length>c;c++){var g=a.slice(0,1);d=a.slice(1),b.indexOf(g)>-1?a=d:e=!0}for(c=0;b.length>c;c++){var h=a.slice(-1);d=a.slice(0,-1),b.indexOf(h)>-1?a=d:f=!0}if(e&&f)return a}return""}},a.fn.extend({spritely:function(b){var c=a(this),d=c.attr("id"),e=new Image,f=a._spritely._spStrip(c.css("background-image"),'url("); ');b=a.extend({type:"sprite",do_once:!1,width:null,height:null,img_width:0,img_height:0,fps:12,no_of_frames:2,stop_after:null},b||{}),e.onload=function(){b.img_width=e.width,b.img_height=e.height},e.src=f,b.img=e,a._spritely.instances||(a._spritely.instances={}),a._spritely.instances[d]||(a._spritely.instances[d]=b.start_at_frame?{current_frame:b.start_at_frame-1}:{current_frame:-1}),a._spritely.instances[d].type=b.type,a._spritely.instances[d].depth=b.depth,b.el=this,b.width=b.width||c.width()||100,b.height=b.height||c.height()||100;var g=function(){return parseInt(1e3/b.fps)};return b.do_once?setTimeout(function(){a._spritely.animate(b)},0):setTimeout(function(){a._spritely.animate(b)},g(b.fps)),this},sprite:function(b){var b=a.extend({type:"sprite",bounce:[0,0,1e3]},b||{});return a(this).spritely(b)},pan:function(b){var b=a.extend({type:"pan",dir:"left",continuous:!0,speed:1},b||{});return a(this).spritely(b)},flyToTap:function(b){var b=a.extend({el_to_move:null,type:"moveToTap",ms:1e3,do_once:!0},b||{});return b.el_to_move&&a(b.el_to_move).active(),a._spritely.activeSprite&&(window.Touch?a(this)[0].ontouchstart=function(b){var c=a._spritely.activeSprite,d=b.touches[0],e=d.pageY-c.height()/2,f=d.pageX-c.width()/2;c.animate({top:e+"px",left:f+"px"},1e3)}:a(this).click(function(b){var c=a._spritely.activeSprite;a(c).stop(!0);var d=c.width(),e=c.height(),f=b.pageX-d/2,g=b.pageY-e/2;c.animate({top:g+"px",left:f+"px"},1e3)})),this},isDraggable:function(b){if(!a(this).draggable)return this;var b=a.extend({type:"isDraggable",start:null,stop:null,drag:null},b||{}),c=a(this).attr("id");return a._spritely.instances[c]?(a._spritely.instances[c].isDraggableOptions=b,a(this).draggable({start:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!0,a(this).stop(!0),a._spritely.instances[b].isDraggableOptions.start&&a._spritely.instances[b].isDraggableOptions.start(this)},drag:b.drag,stop:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!1,a._spritely.instances[b].isDraggableOptions.stop&&a._spritely.instances[b].isDraggableOptions.stop(this)}}),this):this},active:function(){return a._spritely.activeSprite=this,this},activeOnClick:function(){var b=a(this);return window.Touch?b[0].ontouchstart=function(){a._spritely.activeSprite=b}:b.click(function(){a._spritely.activeSprite=b}),this},spRandom:function(b){var b=a.extend({top:50,left:50,right:290,bottom:320,speed:4e3,pause:0},b||{}),c=a(this).attr("id");if(!a._spritely.instances[c])return this;if(!a._spritely.instances[c].stop_random){var d=a._spritely.randomIntBetween,e=d(b.top,b.bottom),f=d(b.left,b.right);a("#"+c).animate({top:e+"px",left:f+"px"},b.speed)}return window.setTimeout(function(){a("#"+c).spRandom(b)},b.speed+b.pause),this},makeAbsolute:function(){return this.each(function(){var b=a(this),c=b.position();b.css({position:"absolute",marginLeft:0,marginTop:0,top:c.top,left:c.left}).remove().appendTo("body")})},spSet:function(b,c){var d=a(this).attr("id");return a._spritely.instances[d][b]=c,this},spGet:function(b){var d=a(this).attr("id");return a._spritely.instances[d][b]},spStop:function(b){return a(this).each(function(){var c=a(this).attr("id");if(a._spritely.instances[c].options.fps&&(a._spritely.instances[c]._last_fps=a._spritely.instances[c].options.fps),a._spritely.instances[c]._stopped=!0,a._spritely.instances[c]._stopped_f1=b,"sprite"==a._spritely.instances[c].type&&a(this).spSet("fps",0),b){var d=a._spritely.getBgY(a(this));a(this).css("background-position","0 "+d)}}),this},spStart:function(){return a(this).each(function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._last_fps||12;"sprite"==a._spritely.instances[b].type&&a(this).spSet("fps",c),a._spritely.instances[b]._stopped=!1}),this},spToggle:function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._stopped||!1,d=a._spritely.instances[b]._stopped_f1||!1;return c?a(this).spStart():a(this).spStop(d),this},fps:function(b){return a(this).each(function(){a(this).spSet("fps",b)}),this},goToFrame:function(b){var c=a(this).attr("id");return a._spritely.instances&&a._spritely.instances[c]&&(a._spritely.instances[c].current_frame=b-1),this},spSpeed:function(b){return a(this).each(function(){a(this).spSet("speed",b)}),this},spRelSpeed:function(b){return a(this).each(function(){var c=a(this).spGet("depth")/100;a(this).spSet("speed",b*c)}),this},spChangeDir:function(b){return a(this).each(function(){a(this).spSet("dir",b)}),this},spState:function(b){return a(this).each(function(){var c=(b-1)*a(this).height()+"px",d=a._spritely.getBgX(a(this)),e=d+" -"+c;a(this).css("background-position",e)}),this},lockTo:function(b,c){return a(this).each(function(){var d=a(this).attr("id");return a._spritely.instances[d]?(a._spritely.instances[d].locked_el=a(this),a._spritely.instances[d].lock_to=a(b),a._spritely.instances[d].lock_to_options=c,a._spritely.instances[d].interval=window.setInterval(function(){if(a._spritely.instances[d].lock_to){var b=a._spritely.instances[d].locked_el,c=a._spritely.instances[d].lock_to,e=a._spritely.instances[d].lock_to_options,f=e.bg_img_width;c.height();var h=a._spritely.getBgY(c),i=a._spritely.getBgX(c),j=parseInt(i)+parseInt(e.left),k=parseInt(h)+parseInt(e.top);j=a._spritely.get_rel_pos(j,f),a(b).css({top:k+"px",left:j+"px"})}},c.interval||20),void 0):this}),this},destroy:function(){a(this);var c=a(this).attr("id");return a._spritely.instances[c]&&a._spritely.instances[c].timeout&&window.clearTimeout(a._spritely.instances[c].timeout),a._spritely.instances[c]&&a._spritely.instances[c].interval&&window.clearInterval(a._spritely.instances[c].interval),delete a._spritely.instances[c],this}})})(jQuery);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(err){}