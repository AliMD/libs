tinyMCEPopup.requireLangPack();var TemplateDialog={preInit:function(){var e=tinyMCEPopup.getParam("template_external_list_url");null!=e&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(e)+'"></sc'+"ript>")},init:function(){var e,t,i,n=tinyMCEPopup.editor;if(e=n.getParam("template_templates",!1),t=document.getElementById("tpath"),!e&&"undefined"!=typeof tinyMCETemplateList)for(i=0,e=[];tinyMCETemplateList.length>i;i++)e.push({title:tinyMCETemplateList[i][0],src:tinyMCETemplateList[i][1],description:tinyMCETemplateList[i][2]});for(i=0;e.length>i;i++)t.options[t.options.length]=new Option(e[i].title,tinyMCEPopup.editor.documentBaseURI.toAbsolute(e[i].src));this.resize(),this.tsrc=e},resize:function(){var e,t,i;self.innerWidth?(e=self.innerWidth-50,t=self.innerHeight-170):(e=document.body.clientWidth-50,t=document.body.clientHeight-160),i=document.getElementById("templatesrc"),i&&(i.style.height=Math.abs(t)+"px",i.style.width=Math.abs(e-5)+"px")},loadCSSFiles:function(e){var t=tinyMCEPopup.editor;tinymce.each(t.getParam("content_css","").split(","),function(i){e.write('<link href="'+t.documentBaseURI.toAbsolute(i)+'" rel="stylesheet" type="text/css" />')})},selectTemplate:function(e,t){var i,n=window.frames.templatesrc.document,r=this.tsrc;if(e)for(n.body.innerHTML=this.templateHTML=this.getFileContents(e),i=0;r.length>i;i++)r[i].title==t&&(document.getElementById("tmpldesc").innerHTML=r[i].description||"")},insert:function(){tinyMCEPopup.execCommand("mceInsertTemplate",!1,{content:this.templateHTML,selection:tinyMCEPopup.editor.selection.getContent()}),tinyMCEPopup.close()},getFileContents:function(e){function t(e){i=0;try{i=new ActiveXObject(e)}catch(e){}return i}var i,n="text/plain";return i=window.ActiveXObject?t("Msxml2.XMLHTTP")||t("Microsoft.XMLHTTP"):new XMLHttpRequest,i.overrideMimeType&&i.overrideMimeType(n),i.open("GET",e,!1),i.send(null),i.responseText}};TemplateDialog.preInit(),tinyMCEPopup.onInit.add(TemplateDialog.init,TemplateDialog);