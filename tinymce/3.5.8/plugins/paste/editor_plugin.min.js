(function(){function e(e,t){return e.getParam(t,i[t])}var t=tinymce.each,i={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_max_consecutive_linebreaks:2,paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(i,n){function r(t,n){var r,s=i.dom;o.onPreProcess.dispatch(o,t),t.node=s.create("div",0,t.content),tinymce.isGecko&&(r=i.selection.getRng(!0),r.startContainer==r.endContainer&&3==r.startContainer.nodeType&&1===t.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(t.node.firstChild.nodeName)&&-1===t.content.indexOf("__MCE_ITEM__")&&s.remove(t.node.firstChild,!0)),o.onPostProcess.dispatch(o,t),t.content=i.serializer.serialize(t.node,{getInner:1,forced_root_block:""}),!n&&i.pasteAsPlainText?(o._insertPlainText(t.content),e(i,"paste_text_sticky")||(i.pasteAsPlainText=!1,i.controlManager.setActive("pastetext",!1))):o._insert(t.content)}function s(e){function n(e){e.preventDefault()}var s,o,a,l,h,c,u=i.selection,d=i.dom,p=i.getBody();if((e.clipboardData||d.doc.dataTransfer)&&(c=(e.clipboardData||d.doc.dataTransfer).getData("Text"),i.pasteAsPlainText))return e.preventDefault(),r({content:d.encode(c).replace(/\r?\n/g,"<br />")}),void 0;if(!d.get("_mcePaste"))return s=d.add(p,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"﻿﻿"),h=p!=i.getDoc().body?d.getPos(i.selection.getStart(),p).y:p.scrollTop+d.getViewPort(i.getWin()).y,d.setStyles(s,{position:"absolute",left:tinymce.isGecko?-40:0,top:h-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE?(l=u.getRng(),a=d.doc.body.createTextRange(),a.moveToElementText(s),a.execCommand("Paste"),d.remove(s),"﻿﻿"===s.innerHTML?(i.execCommand("mcePasteWord"),e.preventDefault(),void 0):(u.setRng(l),u.setContent(""),setTimeout(function(){r({content:s.innerHTML})},0),tinymce.dom.Event.cancel(e))):(d.bind(i.getDoc(),"mousedown",n),d.bind(i.getDoc(),"keydown",n),o=i.selection.getRng(),s=s.firstChild,a=i.getDoc().createRange(),a.setStart(s,0),a.setEnd(s,2),u.setRng(a),window.setTimeout(function(){var e,s="";d.select("div.mcePaste > div.mcePaste").length?s="<p>"+d.encode(c).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(e=d.select("div.mcePaste"),t(e,function(e){var i=e.firstChild;i&&"DIV"==i.nodeName&&i.style.marginTop&&i.style.backgroundColor&&d.remove(i,1),t(d.select("span.Apple-style-span",e),function(e){d.remove(e,1)}),t(d.select("br[data-mce-bogus]",e),function(e){d.remove(e)}),"mcePaste"!=e.parentNode.className&&(s+=e.innerHTML)})),t(d.select("div.mcePaste"),function(e){d.remove(e)}),o&&u.setRng(o),r({content:s}),d.unbind(i.getDoc(),"mousedown",n),d.unbind(i.getDoc(),"keydown",n)},0),void 0)}var o=this;o.editor=i,o.url=n,o.onPreProcess=new tinymce.util.Dispatcher(o),o.onPostProcess=new tinymce.util.Dispatcher(o),o.onPreProcess.add(o._preProcess),o.onPostProcess.add(o._postProcess),o.onPreProcess.add(function(e,t){i.execCallback("paste_preprocess",e,t)}),o.onPostProcess.add(function(e,t){i.execCallback("paste_postprocess",e,t)}),i.onKeyDown.addToTop(function(e,t){return(tinymce.isMac?t.metaKey:t.ctrlKey)&&86==t.keyCode||t.shiftKey&&45==t.keyCode?!1:void 0}),i.pasteAsPlainText=e(i,"paste_text_sticky_default"),i.addCommand("mceInsertClipboardContent",function(e,t){r(t,!0)}),e(i,"paste_text_use_dialog")||i.addCommand("mcePasteText",function(){var t=tinymce.util.Cookie;i.pasteAsPlainText=!i.pasteAsPlainText,i.controlManager.setActive("pastetext",i.pasteAsPlainText),i.pasteAsPlainText&&!t.get("tinymcePasteText")&&(e(i,"paste_text_sticky")?i.windowManager.alert(i.translate("paste.plaintext_mode_sticky")):i.windowManager.alert(i.translate("paste.plaintext_mode")),e(i,"paste_text_notifyalways")||t.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))}),i.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"}),i.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"}),e(i,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?i.onKeyDown.addToTop(function(e,t){((tinymce.isMac?t.metaKey:t.ctrlKey)&&86==t.keyCode||t.shiftKey&&45==t.keyCode)&&s(t)}):i.onPaste.addToTop(function(e,t){return s(t)})),i.onInit.add(function(){i.controlManager.setActive("pastetext",i.pasteAsPlainText),e(i,"paste_block_drop")&&i.dom.bind(i.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(e){return e.preventDefault(),e.stopPropagation(),!1})}),o._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(i,n){function r(e){t(e,function(e){h=e.constructor==RegExp?h.replace(e,""):h.replace(e[0],e[1])})}function s(e,t){if("all"===a)return"";var i=c(u(t.replace(/^(["'])(.*)\1$/,"$2")," "),function(e){return/^(?!mso)/i.test(e)});return i.length?' class="'+i.join(" ")+'"':""}var o,a,l=this.editor,h=n.content,c=tinymce.grep,u=tinymce.explode,d=tinymce.trim;if(0!=l.settings.paste_enable_default_filters){if(tinymce.isIE&&document.documentMode>=9&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(n.content)&&(r([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),r([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])),/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(h)||n.wordContent){n.wordContent=!0,r([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]),e(l,"paste_convert_headers_to_strong")&&(h=h.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")),e(l,"paste_convert_middot_lists")&&r([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]),r([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "]]);do o=h.length,h=h.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(o!=h.length);0==e(l,"paste_retain_style_properties").replace(/^none$/i,"").length?h=h.replace(/<\/?span[^>]*>/gi,""):r([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(e,i,n){var r=[],s=0,o=u(d(n).replace(/&quot;/gi,"'"),";");return t(o,function(e){function t(e){return e+("0"!==e&&/\d$/.test(e))?"px":""}var i,n,o=u(e,":");if(2==o.length){switch(i=o[0].toLowerCase(),n=o[1].toLowerCase(),i){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":return r[s++]=i.replace(/^mso-|-alt$/g,"")+":"+t(n),void 0;case"horiz-align":return r[s++]="text-align:"+n,void 0;case"vert-align":return r[s++]="vertical-align:"+n,void 0;case"font-color":case"mso-foreground":return r[s++]="color:"+n,void 0;case"mso-background":case"mso-highlight":return r[s++]="background:"+n,void 0;case"mso-default-height":return r[s++]="min-height:"+t(n),void 0;case"mso-default-width":return r[s++]="min-width:"+t(n),void 0;case"mso-padding-between-alt":return r[s++]="border-collapse:separate;border-spacing:"+t(n),void 0;case"text-line-through":return("single"==n||"double"==n)&&(r[s++]="text-decoration:line-through"),void 0;case"mso-zero-height":return"yes"==n&&(r[s++]="display:none"),void 0}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(i))return;r[s++]=i+":"+o[1]}}),s>0?i+' style="'+r.join(";")+'"':i}]])}e(l,"paste_convert_headers_to_strong")&&r([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]),r([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]),a=e(l,"paste_strip_class_attributes"),"none"!==a&&(h=h.replace(/ class="([^"]+)"/gi,s),h=h.replace(/ class=([\-\w]+)/gi,s)),e(l,"paste_remove_spans")&&(h=h.replace(/<\/?span[^>]*>/gi,"")),n.content=h}},_postProcess:function(i,n){var r,s=this,o=s.editor,a=o.dom;0!=o.settings.paste_enable_default_filters&&(n.wordContent&&(t(a.select("a",n.node),function(e){e.href&&-1==e.href.indexOf("#_Toc")||a.remove(e,1)}),e(o,"paste_convert_middot_lists")&&s._convertLists(i,n),r=e(o,"paste_retain_style_properties"),tinymce.is(r,"string")&&"all"!==r&&"*"!==r&&(r=tinymce.explode(r.replace(/^none$/i,"")),t(a.select("*",n.node),function(e){var t,i,n,s={},o=0;if(r)for(t=0;r.length>t;t++)i=r[t],n=a.getStyle(e,i),n&&(s[i]=n,o++);a.setAttrib(e,"style",""),r&&o>0?a.setStyles(e,s):"SPAN"!=e.nodeName||e.className||a.remove(e,!0)}))),e(o,"paste_remove_styles")||e(o,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?t(a.select("*[style]",n.node),function(e){e.removeAttribute("style"),e.removeAttribute("data-mce-style")}):tinymce.isWebKit&&t(a.select("*",n.node),function(e){e.removeAttribute("data-mce-style")}))},_convertLists:function(e,i){var n,r,s,o,a,l=e.editor.dom,h=-1,c=[];t(l.select("p",i.node),function(e){var i,a,u,d,p,f="";for(i=e.firstChild;i&&3==i.nodeType;i=i.nextSibling)f+=i.nodeValue;f=e.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g," "),/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(f)&&(a="ul"),/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(f)&&(a="ol"),a?(s=parseFloat(e.style.marginLeft||0),s>h&&c.push(s),n&&a==o?s>h?n=r.appendChild(l.create(a)):h>s&&(d=tinymce.inArray(c,s),p=l.getParents(n.parentNode,a),n=p[p.length-1-d]||n):(n=l.create(a),l.insertAfter(n,e)),t(l.select("span",e),function(e){var t=e.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");"ul"==a&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(t)?l.remove(e):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(t)&&l.remove(e)}),u=e.innerHTML,u="ul"==a?e.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):e.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),r=n.appendChild(l.create("li",0,u)),l.remove(e),h=s,o=a):n=h=0}),a=i.node.innerHTML,-1!=a.indexOf("__MCE_ITEM__")&&(i.node.innerHTML=a.replace(/__MCE_ITEM__/g,""))},_insert:function(e,t){var i=this.editor,n=i.selection.getRng();i.selection.isCollapsed()||n.startContainer==n.endContainer||i.getDoc().execCommand("Delete",!1,null),i.execCommand("mceInsertContent",!1,e,{skip_undo:t})},_insertPlainText:function(i){function n(e){t(e,function(e){i=e.constructor==RegExp?i.replace(e,""):i.replace(e[0],e[1])})}var r=this.editor,s=e(r,"paste_text_linebreaktype"),o=e(r,"paste_text_replacements"),a=tinymce.is;if("string"==typeof i&&i.length>0){/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(i)?n([/[\n\r]+/g]):n([/\r+/g]),n([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"	"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"]]);var l=Number(e(r,"paste_max_consecutive_linebreaks"));if(l>-1){for(var h=RegExp("\n{"+(l+1)+",}","g"),c="";l>c.length;)c+="\n";n([[h,c]])}i=r.dom.decode(tinymce.html.Entities.encodeRaw(i)),a(o,"array")?n(o):a(o,"string")&&n(RegExp(o,"gi")),"none"==s?n([[/\n+/g," "]]):"br"==s?n([[/\n/g,"<br />"]]):"p"==s?n([[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]):n([[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),r.execCommand("mceInsertContent",!1,i)}},_legacySupport:function(){var t=this,i=t.editor;i.addCommand("mcePasteWord",function(){i.windowManager.open({file:t.url+"/pasteword.htm",width:parseInt(e(i,"paste_dialog_width")),height:parseInt(e(i,"paste_dialog_height")),inline:1})}),e(i,"paste_text_use_dialog")&&i.addCommand("mcePasteText",function(){i.windowManager.open({file:t.url+"/pastetext.htm",width:parseInt(e(i,"paste_dialog_width")),height:parseInt(e(i,"paste_dialog_height")),inline:1})}),i.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}}),tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)})();