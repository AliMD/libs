(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(e){var t=this;t.editor=e,e.addCommand("mceVisualChars",t._toggleVisualChars,t),e.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),e.onBeforeGetContent.add(function(e,i){t.state&&"raw"!=i.format&&!i.draft&&(t.state=!0,t._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(e){var t,i,n,r,s,o=this,a=o.editor,l=(a.getDoc(),a.getBody()),c=a.selection;if(o.state=!o.state,a.controlManager.setActive("visualchars",o.state),e&&(s=c.getBookmark()),o.state)for(t=[],tinymce.walk(l,function(e){3==e.nodeType&&e.nodeValue&&-1!=e.nodeValue.indexOf("Â ")&&t.push(e)},"childNodes"),i=0;t.length>i;i++){for(n=t[i].nodeValue,n=n.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),r=a.dom.create("div",null,n);node=r.lastChild;)a.dom.insertAfter(node,t[i]);a.dom.remove(t[i])}else for(t=a.dom.select("span.mceItemNbsp",l),i=t.length-1;i>=0;i--)a.dom.remove(t[i],1);c.moveToBookmark(s)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars)})();