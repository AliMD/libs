var mobilize={options:{whitelistScriptSrc:["mobilize"],whitelistStyleImport:[],whitelistCSSLinks:[],inlineStyleMaxCheckLength:256,forceMobilize:undefined,forceUserAgent:null,mobilizeQueryParameter:"mobilize",haveRemoteDebugLogging:false,remoteDebugLogBaseUrl:"/",reloadOnMobile:false,minImageProcessingWidth:100,},cdnOptions:{localCacheVersion:null,baseURL:null,bundleName:null,javascriptBundles:["js/mobilize.core.mobile.min.js"],errorReportingURL:null,cssBundles:["css/mobilize.core.mobile.min.css"],template:"templates/core.html",templateSource:'<div id="mobile-body"><div data-role="page"><div data-role="header"></div><div id="mobile-content" data-role="content"></div><div data-role="footer"></div></div></div>',version:"XXX"},jQueryMobileLoaded:false,transformComplete:false,onCompleted:null,suspendRenderingAttempted:false,renderingState:"web",init:function(a,b){if(mobilize._init_called){mobilize.log_w("init called more than once. Is mobilize.js initialized both manually and via autoload?");return}mobilize._init_called=true;if(!a){a={}}if(!b){b={}}mobilize.initPlugins();mobilize.extend(mobilize.options,a);mobilize.extend(mobilize.cdnOptions,b);mobilize.log(mobilize.cdnOptions);if(!mobilize.isBrowserSupported()&&!mobilize.options.forceMobilize){mobilize.log("mobilizejs: browser is not supported");return}if(typeof(localStorage)===undefined&&mobilize.options.localCacheVersion){mobilize.log("localStorage not supported for caching.");mobilize.options.localCacheVersion=null}mobilize.initCloud();if(!window.mobilizeCustomInit){mobilize.log("No custom init hook available")}else{mobilize.log("Calling custom init hook");mobilizeCustomInit()}},bootstrap:function(){mobilize.log("bootstrap()");if(mobilize._bootstrap_called){throw"bootstrap called more than once. Is mobilize.js initialized both manually and via autoload?"}mobilize._bootstrap_called=true;var a=mobilize.readCookie("mobilize-mobile");if(!mobilize.isBrowserSupported()&&!mobilize.options.forceMobilize){mobilize.log("mobilize.js: browser is not supported");return}if(mobilize.checkReloadPage(a)){return}function b(){mobilize.log("startProcess");try{if(mobilize.checkMobileBrowser(mobilize.options)){mobilize.renderAsMobile()}else{mobilize.log("Web mode wanted")}}catch(c){mobilize.sendExceptionToCloudService("bootsrap",c);throw c}}document.addEventListener("DOMContentLoaded",b,false)},initCloud:function(){mobilize.log("Initializing URL base for media resources");var d=mobilize.cdnOptions;if(!d.cloudBaseURL){var b=document.getElementsByClassName("mobilize-js-source");var g=0;if(!b.length){mobilize.log("No <script> hints found, do it hard way");var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){b=a[c];g=b.getAttribute("src");if(!g){continue}if(g.indexOf("mobilize.")>=0){break}}}else{b=b[0];g=b.src}if(!g){var f;f="Could not found <script> with class='mobilize-js-source' or src with 'mobilize.' text in HTML to resolve mobilize.js hosting location";mobilize.logError(f);throw f}var e=mobilize.baseurl(g);e=e.substring(0,e.length-4);d.baseURL=e;mobilize.log_d("Found script source URL "+d.baseURL)}},checkReloadPage:function(b){var a=mobilize.checkMobileBrowser(mobilize.options);var c=mobilize.readCookie("mobilize-mobile");mobilize.log("reload on mobile check, got new cookie value:"+c+"  got old cookiea value:"+b);if(!a&&c==null){return false}if(mobilize.options.reloadOnMobile){if(b!=c){mobilize.log("Mobile cookie has changed. Server has asked us to reload in this situation (reloadOnMobile).");mobilize.log("Refreshing page");window.location.reload();return true}mobilize.log("Cookie already exists - continue with normal mobile flow")}return false},domainurl:function(d){var a=d.indexOf("://");if(a>=0){a+=3}else{a=0}var c=d.substring(a,d.length).indexOf("/")+a;var b=d.substring(0,c);return b},autoload:function(){if(window.mobilizeAutoload===false){return}function a(){if(mobilize._autoload_called){return}mobilize._autoload_called=true;mobilize.log_d("Autoloading mobilize.js");mobilize.init();mobilize.bootstrap()}a()},extend:function(c,b){var a;for(a in b){var d=b[a];c[a]=d}},initPlugins:function(){},log:function(a){if(window.console){if(console.log){console.log(a);return}}},log_d:function(a){mobilize.log(a)},log_w:function(a){mobilize.log(a)},logError:function(a){if(console.error){console.error(a)}},sendExceptionToCloudService:function(a,c){mobilize.log("Cloud error reporting activated");if(mobilize.cdnOptions.errorReportingURL){mobilize.log("Reporting to home");var d=new XMLHttpRequest();var e=""+c;var b;b=mobilize.cdnOptions.errorReportingURL;b+="?version="+encodeURIComponent(mobilize.cdnOptions.version);b+="&msg="+encodeURIComponent(e);b+="&task="+encodeURIComponent(a);b+="&bundle="+encodeURIComponent(mobilize.cdnOptions.bundleName);b+="&random="+Math.random();d.open("GET",b,false);d.send(null)}},baseurl:function(c){var a;var b;a=c.indexOf("?");if(a<=0){a=c.length-1}b=c.slice(0,a);if(b[b.length-1]=="/"){b=b.slice(0,b.length-2)}a=b.lastIndexOf("/")+1;b=b.slice(0,a);return b},callWithErrorReporting:function(a){try{a()}catch(b){}},addUrlVar:function(h,g){var e=mobilize.getUrlVars(h);var c=h.split("?",1)[0];c+="?";var d=[];for(var f=0;f<e.length;f++){var b=e[f];var j=e[b];d.push(b+"="+j)}d.push(g);c+=d.join("&");return c},getUrlVars:function(c){if(!this._urlvars){this._urlvars={}}if(!c){c=window.location.href}if(this._urlvars[c]){return this._urlvars[c]}var e=[],d;if(c.indexOf("#")>=0){c=c.slice(0,c.indexOf("#"))}var a=c.slice(c.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){d=a[b].split("=");e.push(d[0]);e[d[0]]=d[1]}this._urlvars[c]=e;return e},createCookie:function(c,d,e){var a="";if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));a="; expires="+b.toGMTString()}document.cookie=c+"="+d+a+"; path=/"},readCookie:function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)===" "){f=f.substring(1,f.length)}if(f.indexOf(e)===0){return f.substring(e.length,f.length)}}return null},eraseCookie:function(a){mobilize.createCookie(a,"",-1)},isMobile:function(a){if(!a){a=(navigator.userAgent||navigator.vendor||window.opera)}function b(d,c){if(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(d)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(d.substr(0,4))){return true}else{return false}}return b(a)},checkMobileBrowser:function(c){var b;var a;if(!c){c={}}a=c.forceUserAgent;b=mobilize.getUrlVars()[mobilize.options.mobilizeQueryParameter];if(c.forceMobilize!==undefined){b=c.forceMobilize}if(b!==undefined&&b!==null){result=(b=="true"||b=="1"||b===true||b===1)}else{result=mobilize.isMobile(a)}mobilize.createCookie("mobilize-mobile",result?"1":"0");return result},clearConflictingJQuery:function(){if(window.jQuery!==undefined){delete window.jQuery}if(window.$!==undefined){delete window.$}},renderAsMobile:function(){mobilize.log("Enabling mobile rendering");mobilize.suspendRendering();mobilize.cleanHead();mobilize.loadMobileResources()},toFullCDNURL:function(b){if(b.length<2){throw"Empty URI"}if(b.indexOf("http")>=0){return b}if(b[0]=="."&&b[1]=="/"){var c=mobilize.baseurl(window.location.href);var a=c+b.substring(2,b.length);return a}if(mobilize.cdnOptions.baseURL===null){throw"mobilize.cdnOptions.baseURL must be defined or auto-detected"}return mobilize.cdnOptions.baseURL+"/"+b},loadMobileResources:function(){var d;var h=this;var j=mobilize.cdnOptions;var g=0;var c=mobilize.cdnOptions.localCacheVersion;if(c){mobilize.log("localStorage enabled for caching. Version:"+c)}mobilize.log("Constructing mobile <head>");var b=[];var k,f;for(d=0;d<j.javascriptBundles.length;d++){k=j.javascriptBundles[d];f=mobilize.toFullCDNURL(k);b.push([k,f])}b.reverse();function e(){if(b.length==0){mobilize.log("All scripts loaded");h.prepareMobileTemplate()}else{var m=b.pop();var i=m[0];var l=m[1];mobilize.log("Loading next script "+l);mobilize.loadScript(i,l,e)}}e();for(d=0;d<j.cssBundles.length;d++){k=j.cssBundles[d];var a=mobilize.toFullCDNURL(k);mobilize.log("Starting CSS load:"+a);mobilize.loadCSS(k,a)}if(c!==null){localStorage.setItem("mobilizejs-localCacheVersion",c)}mobilize.log("Syncronous boostrap done")},getAJAX:function(a,c){mobilize.log("AJAX loading:"+a);var b=new XMLHttpRequest();b.open("GET",a,true);b.onreadystatechange=function(d){if(b.readyState==4){if(b.status==200){c(b.responseText,b.status,b)}else{mobilize.log("Could not AJAX url:"+a+" got status:"+b.status);mobilize.log("Status text:"+b.statusText);mobilize.log("Payload:");mobilize.log(b.responseText)}}};b.send(null)},BUNDLE_TYPE_JS:1,BUNDLE_TYPE_CSS:2,loadBundleFromLocalStorage:function(aBundleType,aBundle,aUrl,aCallback){throw"Currently unsupported";if(!(aBundleType&(mobilize.BUNDLE_TYPE_CSS|mobilize.BUNDLE_TYPE_JS))){mobilize.log("ERROR: Invalid bundle type "+aBundleType);return}function applySource(aSource){if(aBundleType==mobilize.BUNDLE_TYPE_JS){eval.call(null,aSource)}else{if(aBundleType==mobilize.BUNDLE_TYPE_CSS){var s=document.createElement("style");s.innerText=aSource;document.getElementsByTagName("head")[0].appendChild(s)}}localStorage.setItem(aBundle,aSource);if(aCallback){aCallback()}}applySource=mobilize.trappedInternal(applySource);var source=localStorage.getItem(aBundle);var oldVer=localStorage.getItem("mobilizejs-localCacheVersion");var newVer=mobilize.cdnOptions.localCacheVersion;if(oldVer!=newVer){mobilize.log("localStorage versions are different. old:"+oldVer+" new:"+newVer);source=null}if(!source){mobilize.getAJAX(aUrl,applySource)}else{applySource(source)}},loadScript:function(a,b,c){if(mobilize.cdnOptions.localCacheVersion!==null){mobilize.loadBundleFromLocalStorage(mobilize.BUNDLE_TYPE_JS,a,b,c);return}if(false){mobilize.loadScriptWithAjax(b,c)}else{mobilize.loadScriptWithTag(a,b,c)}},loadScriptWithAjax:function(aUrl,aCallback){mobilize.log("Loading script using AJAX for evaluation:"+aUrl);function loaded(aJavascript){try{mobilize.log("Loaded payload for "+aUrl+", now evaling() it ");eval.call(null,aJavascript);aCallback()}catch(e){mobilize.sendExceptionToCloudService("AJAX script load for:"+aURL,e)}}mobilize.getAJAX(aUrl,loaded);return},loadScriptWithTag:function(a,c,e){mobilize.log("Injecting <script> tag to load:"+c);var b=document.createElement("script");b.type="text/javascript";b.setAttribute("src",c);b.src=c;b.onerror=function(h,g,f,i){mobilize.log("Script contained errors:"+c);mobilize.logError(h);try{mobilize.sendExceptionToCloudService("Load script for "+c,"")}catch(h){}mobilize.restoreRendering()};b.onload=b.onreadystatechange=function(){mobilize.log("Script onload handler for "+c);if(!this.done&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){this.done=true;e()}else{mobilize.log("Interesting script state:"+this.readyState)}};var d=document.getElementsByTagName("head")[0];d.appendChild(b)},loadCSS:function(a,b){if(mobilize.cdnOptions.localCacheVersion!==null){mobilize.loadBundleFromLocalStorage(mobilize.BUNDLE_TYPE_CSS,a,b,null);return}var c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("href",b);document.getElementsByTagName("head")[0].appendChild(c)},checkResourceWhitelist:function(d,b){for(var a=0;a<b.length;a++){var c=b[a];if(d.indexOf(c)>=0){return true}}return false},cleanJavascript:function(){mobilize.log_d("Cleaning <script>s");var b=document.getElementsByTagName("script");for(var c=0;c<b.length;c++){var a=b[c];var e=a.getAttribute("src");if(!e){continue}if(!mobilize.checkResourceWhitelist(e,mobilize.options.whitelistScriptSrc)){mobilize.log("Cleaning script tag:"+e);var d=a.parentNode;d.removeChild(a)}}},cleanCSSLink:function(){mobilize.log("Cleaning <link rel='stylesheet'>s");var b=document.getElementsByTagName("link");for(var c=0;c<b.length;c++){script=b[c];var a=script.getAttribute("rel");if(a!="stylesheet"){continue}var e=script.getAttribute("href");if(!mobilize.checkResourceWhitelist(e,mobilize.options.whitelistCSSLinks)){var d=script.parentNode;d.removeChild(script);mobilize.log("Removing stylesheet:"+e)}}},cleanCSSStyle:function(){mobilize.log("Cleaning <style>s");var c=document.getElementsByTagName("style");function a(i){var h=i.parentNode;h.removeChild(i)}for(var d=0;d<c.length;d++){var e=c[d];var g=e.textContent;if(!g){mobilize.log("Interesting style node:");mobilize.log(e);continue}if(e.hasAttribute("class")){if(e.getAttribute("class").indexOf("mobilize-preserve")){continue}}if(g.length<mobilize.options.inlineStyleMaxCheckLength){var f=g.match(/@import url\(.*\);?/mg);if(f!==null){for(var b=0;b<f.length;b++){if(!mobilize.checkResourceWhitelist(f[b],mobilize.options.whitelistStyleImport)){a(e);break}}}}else{a(e)}}},cleanHead:function(){mobilize.cleanJavascript();mobilize.cleanCSSLink();mobilize.cleanCSSStyle()},suspendRendering:function(){mobilize.log("Suspending page rendering");mobilize.renderingState="suspended";function c(){mobilize.log("Hiding body, showing the page is being mobilized logo");var e="body > * { visibility: hidden !important;} \n body > #mobilize-supress { visibility: visible !important; color: #dc3c01; text-align: center; font-family: Helvetica, Arial, sans-serif; font-weight: bold; margin: 5px auto; width: 200px; } \n .ui-mobile-rendering > body { visibility: visible !important }";var f=document.createElement("style");f.setAttribute("type","text/css");f.setAttribute("class","mobilize-supressor mobilize-preserve");f.innerHTML=e;document.head.appendChild(f);var d="<p>Please wait while loading mobile optimized version</p>";d+="<img src="+mobilize.cdnOptions.baseURL+"/css/images/ajax-loader.gif />";d+="<br>";d+="<img src="+mobilize.cdnOptions.baseURL+"/css/images/logo_with_text_128.png />";if(document.getElementById("mobilize-supress")!=null){f=document.createElement("div");f.setAttribute("id","mobilize-supress");f.setAttribute("class","mobilize-supressor");f.innerHTML=d;document.body.insertBefore(f,document.body.firstChild)}f=document.createElement("meta");f.setAttribute("name","viewport");f.setAttribute("class","mobilize-supressor");f.setAttribute("content","width=device-width, minimum-scale=1, maximum-scale=1");document.head.appendChild(f)}function b(){mobilize.log("Supressing image rendering");var d=document.getElementsByTagName("img");var f,g=0;for(f=0;f<d.length;f++){var e=d[f];if(e.hasAttribute("src")){var h=e.src;e.setAttribute("data-orignal-src",h);e.removeAttribute("src");g++}}mobilize.log("Supressed "+g+" <img>s")}document.addEventListener("DOMContentLoaded",b,false);function a(){mobilize.log("Second body rendering suspect added, called from DOMContentLoaded");mobilize.suspendRendering()}if(!document.body){if(!mobilize.suspendRenderingAttempted){mobilize.suspendRenderingAttempted=true;mobilize.log("No <body> available, trying to suspend rendering later");if(document.addEventListener){}return}}if(!document.body){throw"Could not find body while loading?"}c()},restoreRendering:function(){if(mobilize.renderingState=="mobile"){mobilize.log("Attemped to restore rendering twice");return}mobilize.log("Restoring rendering");mobilize.renderingState="mobile";function a(){mobilize.log("Restoring body rendering");var e=document.getElementsByClassName("mobilize-supressor");mobilize.log("Found "+e.length+" supressors");var c;for(c=0;c<e.length;c++){var d=e[c];d.parentNode.removeChild(d)}}function b(){var c=document.getElementsByTagName("img");var e,f=0;for(e=0;e<c.length;e++){var d=c[e];if(d.hasAttribute("data-orignal-src")){d.setAttribute("src",d.getAttribute("data-orignal-src"));f++}}mobilize.log("Restored "+f+" images of all "+c.length+" images")}a();b()},prepareMobileTemplate:function(){mobilize.loadInternalTemplate();mobilize.transform()},loadInternalTemplate:function(){$("body").append("<div id='mobile-template-holder'>"+mobilize.cdnOptions.templateSource+"</div>")},loadMobileTemplate:function(){var c=this;$("body").append("<div id='mobile-template-holder'>");var e=$("#mobile-template-holder");if(e.size()==0){throw"Mobile template loader container missing"}var d=mobilize.toFullCDNURL(mobilize.cdnOptions.template);if(navigator.userAgent.toLowerCase().indexOf("android")>=0){mobilize.log("Avoiding Android cache control problem for AJAX");d+="?android-buster="+Math.random()}mobilize.log("Loading mobile template from URL:"+d);function b(h,f,g){mobilize.log("Text status:"+f);mobilize.log("Template load AJAX complete, status:"+g.status);if(g.status==0){mobilize.log("Oh crap. Not this again.");mobilize.log(h)}if(g.status!=200){return}e.html(h);mobilize.transform()}function a(){mobilize.log("Trapped AJAX call");mobilize.getAJAX(d,b);mobilize.log("done")}var a=mobilize.trapped(a,{scope:mobilize});a()},closeMobileTemplate:function(){},prepareTransform:function(){if(!jQuery){throw"jQuery needed in order to run content transform"}},transform:function(){mobilize.log("Begin mobile transform");try{mobilize.constructHead();mobilize.constructBody();mobilize.completeTransform()}catch(b){mobilize.log("Exception during transform");try{if($("#mobile-template-holder div[data-role=content] > *").size()==0){$("#mobile-content").append($("body > div[id != mobile-template-holder]"))}mobilize.completeTransform()}catch(a){mobilize.log("Not good");mobilize.log(a)}mobilize.restoreRendering();mobilize.sendExceptionToCloudService("transform",b);throw b}},completeTransform:function(){mobilize.transformComplete=true;mobilize.prepareFinish()},rewriteLinkTarget:function(a){return a},remapLinks:function(a,b){a.each(function(){var c=$(this);output=mobilize.rewriteLink(c);if(!output){if(b){b(c)}}})},rewriteLink:function(b){b=$(b);var c=b.attr("href");if(!c){return null}c=mobilize.rewriteLinkTarget(c);b.attr("href",c);return b},constructHead:function(){mobilize.log("constructHead");$("head").append($("#mobile-head").children())},createNavigationBox:function(a,c,d){var b;b=$("<ul data-inset='true' data-role='listview'>");a.each(function(){var h=$(this);var f;var e;var i;mobilize.log("Creating navigation box link "+this);if(this.tagName.toLowerCase()=="a"){f=h;e=false}else{i=h;f=i.find("a");if(f.size()===0){f=null}e=true}if(f){f=mobilize.rewriteLink(f)}if(d){d(b,h,f)}else{var g=$("<li role='option'>");if(f){g.append(f).appendTo(b)}if(e){g.appendTo(i.children())}}});if(c){b.prepend("<li data-role='list-divider'>"+c+"</li>")}return b},constructBody:function(){},swapBody:function(){var a=$("#mobile-body").detach();$("body").empty();$("body").append(a.children())},prepareFinish:function(){mobilize.log("prepareFinish()");if(!mobilize.jQueryMobileLoaded){mobilize.log("Waiting for jQuery Mobile to load")}if(!mobilize.transformComplete){mobilize.log("Waiting transform() to complete")}mobilize.log("mobilize.jQueryMobileLoaded:"+mobilize.jQueryMobileLoaded);mobilize.log("mobilize.transformComplete:"+mobilize.transformComplete);if(mobilize.jQueryMobileLoaded&&mobilize.transformComplete){mobilize.finish()}},finish:function(){this.swapBody();this.restoreRendering();try{$.mobile.initializePage()}catch(a){mobilize.logError("mobilize::finish initializePage failed:"+a);throw a}mobilize.log("Finalizing page mobilization");mobilize.bindEventHandlers();if(mobilize.onCompleted){mobilize.onCompleted()}mobilize.log("Calling mobilizefinish event handlers");$(window).trigger("mobilizefinish")},bindEventHandlers:function(){},isBrowserSupported:function(){var c={};var d=document.createElement("div");d.setAttribute("id","mobilize-mediatest");var e=document.createElement("body");e.appendChild(d);var a=document.getElementsByTagName("html")[0];function b(i){if(!(i in c)){var g=document.createElement("style"),h="@media "+i+" { #mobilize-mediatest { position:absolute; } }";g.type="text/css";if(g.styleSheet){g.styleSheet.cssText=h}else{g.appendChild(document.createTextNode(h))}a.insertBefore(g,a.firstChild);a.insertBefore(e,a.firstChild);d=document.getElementById("mobilize-mediatest");var f=document.defaultView.getComputedStyle(d,null).position;c[i]=f==="absolute";e.appendChild(g);a.removeChild(e)}return c[i]}return b("only all")},defloat:function(b){if(!b.width){width=null}else{width=b.width}mobilize.log("Processing content <img>:"+b+" width:"+b.width);function a(e){if(e.width<mobilize.options.minImageProcessingWidth){return}if(!e.tagName){throw"Was not a DOM element:"+e}if(e.tagName.toLowerCase()!="img"){throw"Was not a <img> element:"+e}var c=$(e);if(c.hasClass("mobilize-no-resize")){return}c.addClass("mobilize-resized");var d;if(e.width&&e.width<512){d=e.width}else{d=512}c.css({width:"100%","max-width":d+"px"});e.style["float"]="none";c.click(function(){var f=c.parents("a");if(f.size()==0){window.open(e.src)}})}if(b.width){a(b)}else{b.onload=function(){a(b)}}},processContentImages:function(a){$(a).find("img").each(function(){mobilize.defloat(this)})},processContentVideos:function(a){var b=mobitube(jQuery);b.process(a)},makeHorizontalScroll:function(f){var b={direction:"x",showScrollBars:true};var e=[];var h=null;function g(){e.forEach(function(k){var m={"z-index":100,position:"absolute",opacity:0.8,};var o=k._$clip;var l=20;var j=o.height()/2-l/2;var p=o.find(".left-arrow");if(p.size()==0){mobilize.log("Scroll-area hint left arrow gone missing :(")}p.offset({top:j,left:16});p.css(m);k.leftArrow=p;var p=o.find(".right-arrow");if(p.size()==0){mobilize.log("Scroll-area hint right arrow gone missing :(")}var n=40;var q={top:j,left:o.offset().left+o.width()-n};p.offset(q);p.css(m);k.rightArrow=p})}function c(){h=null;$(".scroll-arrow").fadeOut(1000)}function d(){var j=$(".scroll-arrow");j.stop(true,true);e.forEach(function(l){var o=l._$clip;var q=l.getScrollPosition();if(q.x>0){var p=l.leftArrow;p.show()}var n=10;var k=l._$view.get(0).scrollWidth;var m=l._$clip.width();if(l._hTracker.pos+n+m<k){var p=l.rightArrow;p.show()}});if(h!=null){clearTimeout(h)}h=setTimeout(c,1500)}var i=new Date().getTime();function a(){var j=new Date().getTime();if(j-i>250){d();i=j}}f.each(function(){var k=$(this).wrap("<div class='pre-scroll-wrapper' />");var n=k.parent();n.scrollview(b);var l=n.data("scrollview");e.push(l);k.css({"overflow-x":"visible","overflow-y":"visible"});var m=$("<div class='scroll-arrow left-arrow'>&#x25C0;</div>");m.hide();n.append(m);var j=$("<div class='scroll-arrow right-arrow'>&#x25B6;</div>");j.hide();n.append(j);n.bind("scrollstart",a);n.bind("scrollmove",a)});$(window).scroll(function(){a()});$(window).bind("mobilizefinish",function(){mobilize.log("Setting up scrollview hint arrow positions");setTimeout(g,5)})},makeNextPrevNavigation:function(b,a){var c=$("<div class=mobile-next-prev data-role=controlgroup data-type=vertical>");b.attr("data-icon","arrow-l");b.attr("data-role","button");a.attr("data-icon","arrow-r");a.attr("data-role","button");a.attr("data-iconpos","right");c.append(b);c.append(a);return c}};mobilize.getattr=function(d,b,c){if(d===undefined||d[b]===undefined){return c}else{return d[b]}};mobilize.setdefault=function(a,b,c){if(a[b]===undefined){a[b]=c}};mobilize.delayedFunction=function callAfter(b,c,a){return function(){var e=mobilize.getattr(a,"scope",b);var d=arguments;setTimeout(function(){b.apply(e,d)},c)}};mobilize.scope=function(b,a){return function(){b.apply(a,arguments)}};mobilize.call=function call(d,a){var j=mobilize.getattr(a,"scope",d);var f=mobilize.getattr(a,"args",undefined);var b=mobilize.getattr(a,"after",undefined);var c=mobilize.getattr(a,"repeat",1);var h=mobilize.getattr(a,"callback",undefined);if(f){if(typeof f!="object"||f.length===undefined){f=[f]}}var e;if(b!==undefined){d=mobilize.scope(d,j);var g=mobilize.scope(function(){var i=mobilize.trap(this.func,{args:this.args});if(this.callback){mobilize.trap(this.callback,{args:i})}},{func:d,callback:h,args:f});for(e=1;e<=c;e++){mobilize.delayedFunction(g,b*e)()}}else{for(e=0;e<c;e++){d.apply(j,f)}}};mobilize.trap=function trap(c,b){var a=undefined;try{a=mobilize.call(c,b)}catch(d){if(b&&b.onerror){b.onerror(d)}else{mobilize.log("mobilize.call options:"+String(b));mobilize.log("Called function:"+c);if(!d.stack){mobilize.log(d.sourceURL+":"+d.line+"\n"+d.name+":"+d.message)}else{mobilize.log(d.stack)}throw d}}finally{if(b&&b.onfinally){b.onfinally()}}return a};mobilize.trapped=function trapped(b,a){return function(){if(!a){a={}}if(arguments.length>0){a.args=arguments}if(!a.scope){a.scope=b}return mobilize.trap(b,a)}};if(typeof(exports)!=="undefined"){exports.mobilize=mobilize};