(function(t,i){"use strict";Foundation.libs.magellan={name:"magellan",version:"4.0.0",settings:{activeClass:"active"},init:function(i,e,s){return this.scope=i||this.scope,Foundation.inherit(this,"data_options"),"object"==typeof e&&t.extend(!0,this.settings,e),"string"!=typeof e?(this.settings.init||(this.fixed_magellan=t("[data-magellan-expedition]"),this.set_threshold(),this.last_destination=t("[data-magellan-destination]").last(),this.events()),this.settings.init):this[e].call(this,s)},events:function(){var e=this;t(this.scope).on("arrival.fndtn.magellan","[data-magellan-arrival]",function(){var i=t(this),s=i.closest("[data-magellan-expedition]"),n=s.attr("data-magellan-active-class")||e.settings.activeClass;i.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(i).removeClass(n),i.addClass(n)}),this.fixed_magellan.on("update-position.fndtn.magellan",function(){t(this)}).trigger("update-position"),t(i).on("resize.fndtn.magellan",function(){this.fixed_magellan.trigger("update-position")}.bind(this)).on("scroll.fndtn.magellan",function(){var s=t(i).scrollTop();e.fixed_magellan.each(function(){var i=t(this);i.data("magellan-top-offset")===undefined&&i.data("magellan-top-offset",i.offset().top),i.data("magellan-fixed-position")===undefined&&i.data("magellan-fixed-position",!1);var n=s+e.settings.threshold>i.data("magellan-top-offset"),o=i.attr("data-magellan-top-offset");i.data("magellan-fixed-position")!=n&&(i.data("magellan-fixed-position",n),n?i.css({position:"fixed",top:0}):i.css({position:"",top:""}),n&&o!==undefined&&0!=o&&i.css({position:"fixed",top:o+"px"}))})}),this.last_destination.length>0&&t(i).on("scroll.fndtn.magellan",function(){var s=t(i).scrollTop(),n=s+t(i).height(),o=Math.ceil(e.last_destination.offset().top);t("[data-magellan-destination]").each(function(){var i=t(this),a=i.attr("data-magellan-destination"),r=i.offset().top-s;e.settings.threshold>=r&&t("[data-magellan-arrival='"+a+"']").trigger("arrival"),n>=t(e.scope).height()&&o>s&&n>o&&t("[data-magellan-arrival]").last().trigger("arrival")})}),this.settings.init=!0},set_threshold:function(){this.settings.threshold||(this.settings.threshold=this.fixed_magellan.length>0?this.outerHeight(this.fixed_magellan,!0):0)},off:function(){t(this.scope).off(".fndtn.magellan")}}})(Foundation.zj,this,this.document);