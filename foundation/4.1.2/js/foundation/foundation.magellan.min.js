(function(e,t){"use strict";Foundation.libs.magellan={name:"magellan",version:"4.0.0",settings:{activeClass:"active"},init:function(t,n,i){return this.scope=t||this.scope,Foundation.inherit(this,"data_options"),"object"==typeof n&&e.extend(!0,this.settings,n),"string"!=typeof n?(this.settings.init||(this.fixed_magellan=e("[data-magellan-expedition]"),this.set_threshold(),this.last_destination=e("[data-magellan-destination]").last(),this.events()),this.settings.init):this[n].call(this,i)},events:function(){var n=this;e(this.scope).on("arrival.fndtn.magellan","[data-magellan-arrival]",function(){var t=e(this),i=t.closest("[data-magellan-expedition]"),r=i.attr("data-magellan-active-class")||n.settings.activeClass;t.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(t).removeClass(r),t.addClass(r)}),this.fixed_magellan.on("update-position.fndtn.magellan",function(){e(this)}).trigger("update-position"),e(t).on("resize.fndtn.magellan",function(){this.fixed_magellan.trigger("update-position")}.bind(this)).on("scroll.fndtn.magellan",function(){var i=e(t).scrollTop();n.fixed_magellan.each(function(){var t=e(this);t.data("magellan-top-offset")===undefined&&t.data("magellan-top-offset",t.offset().top),t.data("magellan-fixed-position")===undefined&&t.data("magellan-fixed-position",!1);var r=i+n.settings.threshold>t.data("magellan-top-offset"),o=t.attr("data-magellan-top-offset");t.data("magellan-fixed-position")!=r&&(t.data("magellan-fixed-position",r),r?t.css({position:"fixed",top:0}):t.css({position:"",top:""}),r&&o!==undefined&&0!=o&&t.css({position:"fixed",top:o+"px"}))})}),this.last_destination.length>0&&e(t).on("scroll.fndtn.magellan",function(){var i=e(t).scrollTop(),r=i+e(t).height(),o=Math.ceil(n.last_destination.offset().top);e("[data-magellan-destination]").each(function(){var t=e(this),a=t.attr("data-magellan-destination"),s=t.offset().top-i;n.settings.threshold>=s&&e("[data-magellan-arrival='"+a+"']").trigger("arrival"),r>=e(n.scope).height()&&o>i&&r>o&&e("[data-magellan-arrival]").last().trigger("arrival")})}),this.settings.init=!0},set_threshold:function(){this.settings.threshold||(this.settings.threshold=this.fixed_magellan.length>0?this.outerHeight(this.fixed_magellan,!0):0)},off:function(){e(this.scope).off(".fndtn.magellan")}}})(Foundation.zj,this,this.document);