(function(){(function(e,t){var n,r;return r=t.document,n=function(){function n(t){this._options=e.extend({name:"tour",labels:{end:"End tour",next:"Next &raquo;",prev:"&laquo; Prev"},keyboard:!0,useLocalStorage:!1,debug:!1,template:"<div class='popover tour'>            <div class='arrow'></div>            <h3 class='popover-title'></h3>            <div class='popover-content'></div>          </div>",afterSetState:function(){},afterGetState:function(){},afterRemoveState:function(){},onStart:function(){},onEnd:function(){},onShow:function(){},onHide:function(){},onShown:function(){}},t),this._steps=[],this.setCurrentStep()}return n.prototype.setState=function(n,r){return n=""+this._options.name+"_"+n,this._options.useLocalStorage?t.localStorage.setItem(n,r):e.cookie(n,r,{expires:36500,path:"/"}),this._options.afterSetState(n,r)},n.prototype.removeState=function(n){return n=""+this._options.name+"_"+n,this._options.useLocalStorage?t.localStorage.removeItem(n):e.removeCookie(n,{path:"/"}),this._options.afterRemoveState(n)},n.prototype.getState=function(n){var r;return r=this._options.useLocalStorage?t.localStorage.getItem(""+this._options.name+"_"+n):e.cookie(""+this._options.name+"_"+n),(void 0===r||"null"===r)&&(r=null),this._options.afterGetState(n,r),r},n.prototype.addStep=function(e){return this._steps.push(e)},n.prototype.getStep=function(t){return null!=this._steps[t]?e.extend({path:"",placement:"right",title:"",content:"",id:"step-"+t,next:t===this._steps.length-1?-1:t+1,prev:t-1,animation:!0,onShow:this._options.onShow,onHide:this._options.onHide,onShown:this._options.onShown,template:this._options.template},this._steps[t]):void 0},n.prototype.start=function(t){var n,i=this;return null==t&&(t=!1),this.ended()&&!t?this._debug("Tour ended, start prevented."):(e(r).off("click.bootstrap-tour",".popover .next").on("click.bootstrap-tour",".popover .next",function(e){return e.preventDefault(),i.next()}),e(r).off("click.bootstrap-tour",".popover .prev").on("click.bootstrap-tour",".popover .prev",function(e){return e.preventDefault(),i.prev()}),e(r).off("click.bootstrap-tour",".popover .end").on("click.bootstrap-tour",".popover .end",function(e){return e.preventDefault(),i.end()}),this._onresize(function(){return i.showStep(i._current)}),this._setupKeyboardNavigation(),n=this._makePromise(null!=this._options.onStart?this._options.onStart(this):void 0),this._callOnPromiseDone(n,this.showStep,this._current))},n.prototype.next=function(){var e;return e=this.hideStep(this._current),this._callOnPromiseDone(e,this.showNextStep)},n.prototype.prev=function(){var e;return e=this.hideStep(this._current),this._callOnPromiseDone(e,this.showPrevStep)},n.prototype.end=function(){var n,i,o=this;return n=function(){return e(r).off("click.bootstrap-tour"),e(r).off("keyup.bootstrap-tour"),e(t).off("resize.bootstrap-tour"),o.setState("end","yes"),null!=o._options.onEnd?o._options.onEnd(o):void 0},i=this.hideStep(this._current),this._callOnPromiseDone(i,n)},n.prototype.ended=function(){return!!this.getState("end")},n.prototype.restart=function(){return this.removeState("current_step"),this.removeState("end"),this.setCurrentStep(0),this.start()},n.prototype.hideStep=function(t){var n,r,i;return i=this.getStep(t),r=this._makePromise(null!=i.onHide?i.onHide(this):void 0),n=function(){var t;return t=e(i.element).popover("hide"),i.reflex?t.css("cursor","").off("click.boostrap-tour"):void 0},this._callOnPromiseDone(r,n),r},n.prototype.showStep=function(t){var n,i,o,a=this;return(o=this.getStep(t))?(n=this._makePromise(null!=o.onShow?o.onShow(this):void 0),i=function(){var n;return a.setCurrentStep(t),n="function"==typeof o.path?o.path.call():o.path,a._redirect(n,r.location.pathname)?(a._debug("Redirect to "+n),r.location.href=n,void 0):null!=o.element&&0!==e(o.element).length&&e(o.element).is(":visible")?(a._showPopover(o,t),null!=o.onShown&&o.onShown(a),a._debug("Step "+(a._current+1)+" of "+a._steps.length)):(a._debug("Skip the step "+(a._current+1)+". The element does not exist or is not visible."),a.showNextStep(),void 0)},this._callOnPromiseDone(n,i)):void 0},n.prototype.setCurrentStep=function(e){return null!=e?(this._current=e,this.setState("current_step",e)):(this._current=this.getState("current_step"),this._current=null===this._current?0:parseInt(this._current))},n.prototype.showNextStep=function(){var e;return e=this.getStep(this._current),this.showStep(e.next)},n.prototype.showPrevStep=function(){var e;return e=this.getStep(this._current),this.showStep(e.prev)},n.prototype._debug=function(e){return this._options.debug?t.console.log("Bootstrap Tour '"+this._options.name+"' | "+e):void 0},n.prototype._redirect=function(e,t){return null!=e&&""!==e&&e.replace(/\?.*$/,"").replace(/\/?$/,"")!==t.replace(/\/?$/,"")},n.prototype._showPopover=function(t){var n,r,i,o,a=this;return r=""+t.content+"<br /><p>",o=e.extend({},this._options),t.options&&e.extend(o,t.options),t.reflex&&e(t.element).css("cursor","pointer").on("click.bootstrap-tour",function(){return a.next()}),i=[],t.prev>=0&&i.push("<a href='#"+t.prev+"' class='prev'>"+o.labels.prev+"</a>"),t.next>=0&&i.push("<a href='#"+t.next+"' class='next'>"+o.labels.next+"</a>"),r+=i.join(" | "),r+="<a href='#' class='pull-right end'>"+o.labels.end+"</a>",e(t.element).popover("destroy").popover({placement:t.placement,trigger:"manual",title:t.title,content:r,html:!0,animation:t.animation,container:"body",template:t.template}).popover("show"),n=e(t.element).data("popover").tip(),n.attr("id",t.id),this._reposition(n,t),this._scrollIntoView(n)},n.prototype._reposition=function(t,n){var i,o,a,s,c,l,u;if(c=t[0].offsetWidth,s=t[0].offsetHeight,u=t.offset(),a=u.left,l=u.top,i=e(r).outerHeight()-u.top-e(t).outerHeight(),0>i&&(u.top=u.top+i),o=e("html").outerWidth()-u.left-e(t).outerWidth(),0>o&&(u.left=u.left+o),0>u.top&&(u.top=0),0>u.left&&(u.left=0),t.offset(u),"bottom"===n.placement||"top"===n.placement){if(a!==u.left)return this._replaceArrow(t,2*(u.left-a),c,"left")}else if(l!==u.top)return this._replaceArrow(t,2*(u.top-l),s,"top")},n.prototype._replaceArrow=function(e,t,n,r){return e.find(".arrow").css(r,t?50*(1-t/n)+"%":"")},n.prototype._scrollIntoView=function(n){var r;return r=n.get(0).getBoundingClientRect(),r.top>=0&&r.bottom<e(t).height()&&r.left>=0&&r.right<e(t).width()?void 0:n.get(0).scrollIntoView(!0)},n.prototype._onresize=function(n,r){return e(t).on("resize.bootstrap-tour",function(){return clearTimeout(r),r=setTimeout(n,100)})},n.prototype._setupKeyboardNavigation=function(){var t=this;return this._options.keyboard?e(r).on("keyup.bootstrap-tour",function(e){if(e.which)switch(e.which){case 39:if(e.preventDefault(),t._current<t._steps.length-1)return t.next();break;case 37:if(e.preventDefault(),t._current>0)return t.prev()}}):void 0},n.prototype._makePromise=function(t){return t&&e.isFunction(t.then)?t:null},n.prototype._callOnPromiseDone=function(e,t,n){var r=this;return e?e.then(function(){return t.call(r,n)}):t.call(this,n)},n}(),t.Tour=n})(jQuery,window)}).call(this);