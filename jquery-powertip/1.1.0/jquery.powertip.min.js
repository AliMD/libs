(function(e){"use strict";function t(e,t,n){function i(i,r){a(),e.data("hasActiveHover")||(i?(r&&e.data("forcedOpen",!0),n.showTip(e)):(u.popOpenImminent=!0,s=setTimeout(function(){s=null,o(e)},t.intentPollInterval)))}function r(i){a(),e.data("hasActiveHover")&&(u.popOpenImminent=!1,e.data("forcedOpen",!1),i?n.hideTip(e):s=setTimeout(function(){s=null,n.hideTip(e)},t.closeDelay))}function o(){var r=Math.abs(u.previousX-u.currentX),o=Math.abs(u.previousY-u.currentY),a=r+o;t.intentSensitivity>a?n.showTip(e):(u.previousX=u.currentX,u.previousY=u.currentY,i())}function a(){s=clearTimeout(s)}var s=null;return{show:i,hide:r,cancel:a}}function n(t){function n(e){e.data("hasActiveHover",!0),m.queue(function(t){i(e),t()})}function i(n){if(n.data("hasActiveHover")){if(u.isPopOpen)return u.isClosing||r(u.activeHover),m.delay(100).queue(function(e){i(n),e()}),void 0;n.trigger("powerTipPreRender");var o=n.data("powertip"),a=n.data("powertiptarget"),l=n.data("powertipjq"),c=a?e("#"+a):[];if(o)m.html(o);else if(l&&l.length>0)m.empty(),l.clone(!0,!0).appendTo(m);else{if(!(c&&c.length>0))return;m.html(e("#"+a).html())}n.trigger("powerTipRender"),s.on("closePowerTip",function(){n.data("displayController").hide(!0)}),u.activeHover=n,u.isPopOpen=!0,m.data("followMouse",t.followMouse),m.data("mouseOnToPopup",t.mouseOnToPopup),t.followMouse?h():(p(n),u.isFixedPopOpen=!0),m.fadeIn(t.fadeInTime,function(){u.desyncTimeout||(u.desyncTimeout=setInterval(d,500)),n.trigger("powerTipOpen")})}}function r(e){u.isClosing=!0,e.data("hasActiveHover",!1),e.data("forcedOpen",!1),u.activeHover=null,u.isPopOpen=!1,u.desyncTimeout=clearInterval(u.desyncTimeout),s.off("closePowerTip"),m.fadeOut(t.fadeOutTime,function(){u.isClosing=!1,u.isFixedPopOpen=!1,m.removeClass(),g(u.currentX+t.offset,u.currentY+t.offset),e.trigger("powerTipClose")})}function d(){if(u.isPopOpen&&!u.isClosing){var e=!1;u.activeHover.data("hasActiveHover")===!1?e=!0:o(u.activeHover)||u.activeHover.is(":focus")||u.activeHover.data("forcedOpen")||(m.data("mouseOnToPopup")?o(m)||(e=!0):e=!0),e&&r(u.activeHover)}}function h(){if(u.isPopOpen&&!u.isFixedPopOpen||u.popOpenImminent&&!u.isFixedPopOpen&&m.data("hasMouseMove")){var e=l.scrollTop(),n=l.width(),i=l.height(),r=m.outerWidth(),o=m.outerHeight(),a=0,s=0;a=n>r+u.currentX+t.offset?u.currentX+t.offset:n-r,s=e+i>o+u.currentY+t.offset?u.currentY+t.offset:e+i-o,g(a,s)}}function p(n){var i,r,o,s,l=m.outerWidth(),c=m.outerHeight();t.smartPlacement?(i=e.fn.powerTip.smartPlacementLists[t.placement],e.each(i,function(e,t){return r=f(n,t,l,c),o=t,s=a(r,l,c),0===s.length?!1:void 0})):(r=f(n,t.placement,l,c),o=t.placement),m.addClass(o),g(r.x,r.y)}function f(e,n,i,r){var o=e.offset(),a=e.outerWidth(),s=e.outerHeight(),l=0,c=0;switch(n){case"n":l=o.left+a/2-i/2,c=o.top-r-t.offset;break;case"e":l=o.left+a+t.offset,c=o.top+s/2-r/2;break;case"s":l=o.left+a/2-i/2,c=o.top+s+t.offset;break;case"w":l=o.left-i-t.offset,c=o.top+s/2-r/2;break;case"nw":l=o.left-i+20,c=o.top-r-t.offset;break;case"ne":l=o.left+a-20,c=o.top-r-t.offset;break;case"sw":l=o.left-i+20,c=o.top+s+t.offset;break;case"se":l=o.left+a-20,c=o.top+s+t.offset}return{x:Math.round(l),y:Math.round(c)}}function g(e,t){m.css("left",e+"px"),m.css("top",t+"px")}var m=e("#"+t.popupId);return 0===m.length&&(m=e("<div></div>",{id:t.popupId}),0===c.length&&(c=e("body")),c.append(m)),t.followMouse&&(m.data("hasMouseMove")||s.on({mousemove:h,scroll:h}),m.data("hasMouseMove",!0)),(t.followMouse||t.mouseOnToPopup)&&m.on({mouseenter:function(){(m.data("followMouse")||m.data("mouseOnToPopup"))&&u.activeHover&&u.activeHover.data("displayController").cancel()},mouseleave:function(){m.data("mouseOnToPopup")&&u.activeHover&&u.activeHover.data("displayController").hide()}}),{showTip:n,hideTip:r}}function i(){var t=0,n=0;u.mouseTrackingActive||(u.mouseTrackingActive=!0,e(function(){t=s.scrollLeft(),n=s.scrollTop()}),s.on({mousemove:r,scroll:function(){var e=s.scrollLeft(),i=s.scrollTop();e!==t&&(u.currentX+=e-t,t=e),i!==n&&(u.currentY+=i-n,n=i)}}))}function r(e){u.currentX=e.pageX,u.currentY=e.pageY}function o(e){var t=e.offset();return u.currentX>=t.left&&u.currentX<=t.left+e.outerWidth()&&u.currentY>=t.top&&u.currentY<=t.top+e.outerHeight()}function a(e,t,n){var i=l.scrollLeft(),r=l.scrollTop(),o=l.width(),a=l.height(),s=[];return r>e.y&&s.push("top"),e.y+n>r+a&&s.push("bottom"),i>e.x&&s.push("left"),e.x+t>i+o&&s.push("right"),s}var s=e(document),l=e(window),c=e("body"),u={isPopOpen:!1,isFixedPopOpen:!1,isClosing:!1,popOpenImminent:!1,activeHover:null,currentX:0,currentY:0,previousX:0,previousY:0,desyncTimeout:null,mouseTrackingActive:!1};e.fn.powerTip=function(a){if(!this.length)return this;var s=e.extend({},e.fn.powerTip.defaults,a),l=new n(s);return i(),this.each(function(){var n=e(this),i=n.data("powertip"),r=n.data("powertipjq"),o=n.data("powertiptarget"),a=n.attr("title");i||o||r||!a||(n.data("powertip",a),n.removeAttr("title")),n.data("displayController",new t(n,s,l))}),this.on({mouseenter:function(t){r(t),u.previousX=t.pageX,u.previousY=t.pageY,e(this).data("displayController").show()},mouseleave:function(){e(this).data("displayController").hide()},focus:function(){var t=e(this);o(t)||t.data("displayController").show(!0)},blur:function(){e(this).data("displayController").hide(!0)}})},e.fn.powerTip.defaults={fadeInTime:200,fadeOutTime:100,followMouse:!1,popupId:"powerTip",intentSensitivity:7,intentPollInterval:100,closeDelay:100,placement:"n",smartPlacement:!1,offset:10,mouseOnToPopup:!1},e.fn.powerTip.smartPlacementLists={n:["n","ne","nw","s"],e:["e","ne","se","w","nw","sw","n","s","e"],s:["s","se","sw","n"],w:["w","nw","sw","e","ne","se","n","s","w"],nw:["nw","w","sw","n","s","se","nw"],ne:["ne","e","se","n","s","sw","ne"],sw:["sw","w","nw","s","n","ne","sw"],se:["se","e","ne","s","n","nw","se"]},e.powerTip={showTip:function(t){e.powerTip.closeTip(),t=t.first(),o(t)||t.data("displayController").show(!0,!0)},closeTip:function(){s.triggerHandler("closePowerTip")}}})(jQuery);