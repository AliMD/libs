OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(e,t,i,n){this.layername=i,OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e,t,{},n]),this.extension=this.format.split("/")[1].toLowerCase(),this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(e){return null==e&&(e=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){function t(e,t){e+="";for(var i=[],n=0;t>n;++n)i.push("0");return i.join("").substring(0,t-e.length)+e}var i=this.getServerResolution(),n=this.maxExtent,r=this.tileSize,s=Math.round((e.left-n.left)/(i*r.w)),o=Math.round((e.bottom-n.bottom)/(i*r.h)),a=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,i):this.map.getZoom(),l=[this.layername,t(a,2),t(parseInt(s/1e6),3),t(parseInt(s/1e3)%1e3,3),t(parseInt(s)%1e3,3),t(parseInt(o/1e6),3),t(parseInt(o/1e3)%1e3,3),t(parseInt(o)%1e3,3)+"."+this.extension],h=l.join("/"),c=this.url;return OpenLayers.Util.isArray(c)&&(c=this.selectUrl(h,c)),c="/"==c.charAt(c.length-1)?c:c+"/",c+h},CLASS_NAME:"OpenLayers.Layer.TileCache"});