if(OpenLayers.Class.isPrototype=function(){},OpenLayers.Class.create=function(){return function(){arguments&&arguments[0]!=OpenLayers.Class.isPrototype&&this.initialize.apply(this,arguments)}},OpenLayers.Class.inherit=function(e){var t=function(){e.call(this)},i=[t].concat(Array.prototype.slice.call(arguments));return OpenLayers.inherit.apply(null,i),t.prototype},OpenLayers.Util.clearArray=function(e){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"array = []"})),e.length=0},OpenLayers.Util.setOpacity=function(e,t){OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,t)},OpenLayers.Util.safeStopPropagation=function(e){OpenLayers.Event.stop(e,!0)},OpenLayers.Util.getArgs=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Util.getParameters"})),OpenLayers.Util.getParameters(e)},OpenLayers.nullHandler=function(e){OpenLayers.Console.userError(OpenLayers.i18n("unhandledRequest",{statusText:e.statusText}))},OpenLayers.loadURL=function(e,t,i,n,r){"string"==typeof t&&(t=OpenLayers.Util.getParameters(t));var s=n?n:OpenLayers.nullHandler,o=r?r:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:e,params:t,success:s,failure:o,scope:i})},OpenLayers.parseXMLString=function(e){var t=e.indexOf("<");t>0&&(e=e.substring(t));var i=OpenLayers.Util.Try(function(){var t=new ActiveXObject("Microsoft.XMLDOM");return t.loadXML(e),t},function(){return(new DOMParser).parseFromString(e,"text/xml")},function(){var t=new XMLHttpRequest;return t.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),t.overrideMimeType&&t.overrideMimeType("text/xml"),t.send(null),t.responseXML});return i},OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0},OpenLayers.Ajax.Responders={responders:[],register:function(e){for(var t=0;this.responders.length>t;t++)if(e==this.responders[t])return;this.responders.push(e)},unregister:function(e){OpenLayers.Util.removeItem(this.reponders,e)},dispatch:function(e,t,i){for(var n,r=0;this.responders.length>r;r++)if(n=this.responders[r],n[e]&&"function"==typeof n[e])try{n[e].apply(n,[t,i])}catch(s){}}},OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--}}),OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(e){this.options={method:"post",asynchronous:!0,contentType:"application/xml",parameters:""},OpenLayers.Util.extend(this.options,e||{}),this.options.method=this.options.method.toLowerCase(),"string"==typeof this.options.parameters&&(this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters))}}),OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:!1,initialize:function(e,t){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[t]),OpenLayers.ProxyHost&&OpenLayers.String.startsWith(e,"http")&&(e=OpenLayers.ProxyHost+encodeURIComponent(e)),this.transport=OpenLayers.Ajax.getTransport(),this.request(e)},request:function(e){this.url=e,this.method=this.options.method;var t=OpenLayers.Util.extend({},this.options.parameters);"get"!=this.method&&"post"!=this.method&&(t._method=this.method,this.method="post"),this.parameters=t,(t=OpenLayers.Util.getParameterString(t))&&("get"==this.method?this.url+=(this.url.indexOf("?")>-1?"&":"?")+t:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(t+="&_="));try{var i=new OpenLayers.Ajax.Response(this);this.options.onCreate&&this.options.onCreate(i),OpenLayers.Ajax.Responders.dispatch("onCreate",this,i),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10),this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this),this.setRequestHeaders(),this.body="post"==this.method?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(n){this.dispatchException(n)}},onStateChange:function(){var e=this.transport.readyState;e>1&&(4!=e||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",OpenLayers:!0};if("post"==this.method&&(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&2005>(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]&&(e.Connection="close")),"object"==typeof this.options.requestHeaders){var t=this.options.requestHeaders;if("function"==typeof t.push)for(var i=0,n=t.length;n>i;i+=2)e[t[i]]=t[i+1];else for(var i in t)e[i]=t[i]}for(var r in e)this.transport.setRequestHeader(r,e[r])},success:function(){var e=this.getStatus();return!e||e>=200&&300>e},getStatus:function(){try{return this.transport.status||0}catch(e){return 0}},respondToReadyState:function(e){var t=OpenLayers.Ajax.Request.Events[e],i=new OpenLayers.Ajax.Response(this);if("Complete"==t){try{this._complete=!0,(this.options["on"+i.status]||this.options["on"+(this.success()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(i)}catch(n){this.dispatchException(n)}i.getHeader("Content-type")}try{(this.options["on"+t]||OpenLayers.Ajax.emptyFunction)(i),OpenLayers.Ajax.Responders.dispatch("on"+t,this,i)}catch(n){this.dispatchException(n)}"Complete"==t&&(this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction)},getHeader:function(e){try{return this.transport.getResponseHeader(e)}catch(t){return null}},dispatchException:function(e){var t=this.options.onException;if(t)t(this,e),OpenLayers.Ajax.Responders.dispatch("onException",this,e);else{for(var i=!1,n=OpenLayers.Ajax.Responders.responders,r=0;n.length>r;r++)if(n[r].onException){i=!0;break}if(!i)throw e;OpenLayers.Ajax.Responders.dispatch("onException",this,e)}}}),OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:"",initialize:function(e){this.request=e;var t=this.transport=e.transport,i=this.readyState=t.readyState;if((i>2&&(!window.attachEvent||window.opera)||4==i)&&(this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=null==t.responseText?"":t.responseText+""),4==i){var n=t.responseXML;this.responseXML=void 0===n?null:n}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(e){return this.transport.getResponseHeader(e)}}),OpenLayers.Ajax.getElementsByTagNameNS=function(e,t,i,n){var r=null;return r=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t,n):e.getElementsByTagName(i+":"+n)},OpenLayers.Ajax.serializeXMLToString=function(e){var t=new XMLSerializer,i=t.serializeToString(e);return i},OpenLayers.Util.extend(OpenLayers.Element,{hide:function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"element.style.display = 'none';"}));for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]);i&&(i.style.display="none")}},show:function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"element.style.display = '';"}));for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]);i&&(i.style.display="")}},getDimensions:function(e){if(e=OpenLayers.Util.getElement(e),"none"!=OpenLayers.Element.getStyle(e,"display"))return{width:e.offsetWidth,height:e.offsetHeight};var t=e.style,i=t.visibility,n=t.position,r=t.display;t.visibility="hidden",t.position="absolute",t.display="";var s=e.clientWidth,o=e.clientHeight;return t.display=r,t.position=n,t.visibility=i,{width:s,height:o}}}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.startsWith"})),OpenLayers.String.startsWith(this,e)}),String.prototype.contains||(String.prototype.contains=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.contains"})),OpenLayers.String.contains(this,e)}),String.prototype.trim||(String.prototype.trim=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.trim"})),OpenLayers.String.trim(this)}),String.prototype.camelize||(String.prototype.camelize=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.camelize"})),OpenLayers.String.camelize(this)}),Function.prototype.bind||(Function.prototype.bind=function(){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bind"})),Array.prototype.unshift.apply(arguments,[this]),OpenLayers.Function.bind.apply(null,arguments)}),Function.prototype.bindAsEventListener||(Function.prototype.bindAsEventListener=function(e){return OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bindAsEventListener"})),OpenLayers.Function.bindAsEventListener(this,e)}),window.Event)OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event);else var Event=OpenLayers.Event;OpenLayers.Util.extend(OpenLayers.Tile.prototype,{getBoundsFromBaseLayer:function(e){var t=OpenLayers.i18n("reprojectDeprecated",{layerName:this.layer.name});OpenLayers.Console.warn(t);var i=this.layer.map.getLonLatFromLayerPx(e),n=e.clone();n.x+=this.size.w,n.y+=this.size.h;var r=this.layer.map.getLonLatFromLayerPx(n);i.lon>r.lon&&(0>i.lon?i.lon=-180-(i.lon+180):r.lon=180+r.lon+180);var s=new OpenLayers.Bounds(i.lon,r.lat,r.lon,i.lat);return s}}),OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:!1,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.handler&&this.handler.destroy(),this.handler=null,this.map.events.un({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),OpenLayers.Event.stopObserving(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.stopObserving(window,"mousewheel",this.wheelObserver),OpenLayers.Event.stopObserving(document,"mousewheel",this.wheelObserver),this.wheelObserver=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.map.events.on({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),this.registerWheelEvents()},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this),OpenLayers.Event.observe(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.observe(window,"mousewheel",this.wheelObserver),OpenLayers.Event.observe(document,"mousewheel",this.wheelObserver)},defaultClick:function(e){if(OpenLayers.Event.isLeftClick(e)){var t=!this.performedDrag;return this.performedDrag=!1,t}},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);return this.map.setCenter(t,this.map.zoom+1),OpenLayers.Event.stop(e),!1},defaultMouseDown:function(e){OpenLayers.Event.isLeftClick(e)&&(this.mouseDragStart=e.xy.clone(),this.performedDrag=!1,e.shiftKey&&(this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox)),document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(e))},defaultMouseMove:function(e){if(this.mousePosition=e.xy.clone(),null!=this.mouseDragStart){if(this.zoomBox){var t=Math.abs(this.mouseDragStart.x-e.xy.x),i=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,t)+"px",this.zoomBox.style.height=Math.max(1,i)+"px",e.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=e.xy.x+"px"),e.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=e.xy.y+"px")}else{var t=this.mouseDragStart.x-e.xy.x,i=this.mouseDragStart.y-e.xy.y,n=this.map.getSize(),r=new OpenLayers.Pixel(n.w/2+t,n.h/2+i),s=this.map.getLonLatFromViewPortPx(r);this.map.setCenter(s,null,!0),this.mouseDragStart=e.xy.clone(),this.map.div.style.cursor="move"}this.performedDrag=!0}},defaultMouseUp:function(e){OpenLayers.Event.isLeftClick(e)&&(this.zoomBox?this.zoomBoxEnd(e):this.performedDrag&&this.map.setCenter(this.map.center),document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="")},defaultMouseOut:function(e){null!=this.mouseDragStart&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.zoomBox&&this.removeZoomBox(),this.mouseDragStart=null)},defaultWheelUp:function(e){this.map.getZoom()<=this.map.getNumZoomLevels()&&this.map.setCenter(this.map.getLonLatFromPixel(e.xy),this.map.getZoom()+1)},defaultWheelDown:function(e){this.map.getZoom()>0&&this.map.setCenter(this.map.getLonLatFromPixel(e.xy),this.map.getZoom()-1)},zoomBoxEnd:function(e){if(null!=this.mouseDragStart){if(Math.abs(this.mouseDragStart.x-e.xy.x)>5||Math.abs(this.mouseDragStart.y-e.xy.y)>5){var t=this.map.getLonLatFromViewPortPx(this.mouseDragStart),i=this.map.getLonLatFromViewPortPx(e.xy),n=Math.max(t.lat,i.lat),r=Math.min(t.lat,i.lat),s=Math.min(t.lon,i.lon),o=Math.max(t.lon,i.lon),a=new OpenLayers.Bounds(s,r,o,n);this.map.zoomToExtent(a)}else{var i=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(new OpenLayers.LonLat(i.lon,i.lat),this.map.getZoom()+1)}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null},onWheelEvent:function(e){for(var t=!1,i=OpenLayers.Event.element(e);null!=i;){if(this.map&&i==this.map.div){t=!0;break}i=i.parentNode}if(t){var n=0;e||(e=window.event),e.wheelDelta?(n=e.wheelDelta/120,window.opera&&9.2>window.opera.version()&&(n=-n)):e.detail&&(n=-e.detail/3),n&&(e.xy=this.mousePosition,0>n?this.defaultWheelDown(e):this.defaultWheelUp(e)),OpenLayers.Event.stop(e)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"}),OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y),e&&(this.position=e),t&&(this.direction=t),this.measureDivs=[]},destroy:function(){for(var e in this.buttons){var t=this.buttons[e];t.map=null,t.events.destroy()}OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments),this.buttons={};var e=new OpenLayers.Size(28,28),t=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);return this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",t,e,"Shift->Drag to zoom to area"),t=t.add("vertical"==this.direction?0:e.w,"vertical"==this.direction?e.h:0),this._addButton("pan","panning-hand-off.png","panning-hand-on.png",t,e,"Drag the map to pan."),t=t.add("vertical"==this.direction?0:e.w,"vertical"==this.direction?e.h:0),this.switchModeTo("pan"),this.div},_addButton:function(e,t,i,n,r,s){var o=OpenLayers.Util.getImageLocation(t),a=OpenLayers.Util.getImageLocation(i),l=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+e,n,r,o,"absolute");return this.div.appendChild(l),l.imgLocation=o,l.activeImgLocation=a,l.events=new OpenLayers.Events(this,l,null,!0),l.events.on({mousedown:this.buttonDown,mouseup:this.buttonUp,dblclick:OpenLayers.Event.stop,scope:this}),l.action=e,l.title=s,l.alt=s,l.map=this.map,this.buttons[e]=l,l},buttonDown:function(e){OpenLayers.Event.isLeftClick(e)&&(this.buttonClicked=e.element.action,OpenLayers.Event.stop(e))},buttonUp:function(e){OpenLayers.Event.isLeftClick(e)&&null!=this.buttonClicked&&(this.buttonClicked==e.element.action&&this.switchModeTo(e.element.action),OpenLayers.Event.stop(e),this.buttonClicked=null)},defaultDblClick:function(e){this.switchModeTo("pan"),this.performedDrag=!1;var t=this.map.getLonLatFromViewPortPx(e.xy);return this.map.setCenter(t,this.map.zoom+1),OpenLayers.Event.stop(e),!1},defaultMouseDown:function(e){if(OpenLayers.Event.isLeftClick(e)){switch(this.mouseDragStart=e.xy.clone(),this.performedDrag=!1,this.startViaKeyboard=!1,e.shiftKey&&"zoombox"!=this.mode?(this.switchModeTo("zoombox"),this.startViaKeyboard=!0):e.altKey&&"measure"!=this.mode?this.switchModeTo("measure"):this.mode||this.switchModeTo("pan"),this.mode){case"zoombox":this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),this.performedDrag=!0;break;case"measure":var t="";if(this.measureStart){var i=this.map.getLonLatFromViewPortPx(this.mouseDragStart);t=OpenLayers.Util.distVincenty(this.measureStart,i),t=Math.round(100*t)/100,t+="km",this.measureStartBox=this.measureBox}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart),this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBox.style.width="4px",this.measureBox.style.height="4px",this.measureBox.style.fontSize="1px",this.measureBox.style.backgroundColor="red",this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),t&&(this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBoxDistance.innerHTML=t,this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBoxDistance),this.measureDivs.push(this.measureBoxDistance)),this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move"}document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(e)}},switchModeTo:function(e){if(e!=this.mode){if(this.mode&&this.buttons[this.mode]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation),"measure"==this.mode&&"measure"!=e){for(var t=0,i=this.measureDivs.length;i>t;t++)this.measureDivs[t]&&this.map.layerContainerDiv.removeChild(this.measureDivs[t]);this.measureDivs=[],this.measureStart=null}switch(this.mode=e,this.buttons[e]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[e],null,null,null,this.buttons[e].activeImgLocation),this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor=""}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(e){if(null!=this.mouseDragStart){switch(this.mode){case"zoombox":var t=Math.abs(this.mouseDragStart.x-e.xy.x),i=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,t)+"px",this.zoomBox.style.height=Math.max(1,i)+"px",e.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=e.xy.x+"px"),e.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=e.xy.y+"px");break;default:var t=this.mouseDragStart.x-e.xy.x,i=this.mouseDragStart.y-e.xy.y,n=this.map.getSize(),r=new OpenLayers.Pixel(n.w/2+t,n.h/2+i),s=this.map.getLonLatFromViewPortPx(r);this.map.setCenter(s,null,!0),this.mouseDragStart=e.xy.clone()}this.performedDrag=!0}},defaultMouseUp:function(e){if(OpenLayers.Event.isLeftClick(e)){switch(this.mode){case"zoombox":this.zoomBoxEnd(e),this.startViaKeyboard&&this.leaveMode();break;case"pan":this.performedDrag&&this.map.setCenter(this.map.center)}document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="default"}},defaultMouseOut:function(e){null!=this.mouseDragStart&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.zoomBox&&(this.removeZoomBox(),this.startViaKeyboard&&this.leaveMode()),this.mouseDragStart=null,this.map.div.style.cursor="default")},defaultClick:function(){return this.performedDrag?(this.performedDrag=!1,!1):void 0},CLASS_NAME:"OpenLayers.Control.MouseToolbar"}),OpenLayers.Control.MouseToolbar.X=6,OpenLayers.Control.MouseToolbar.Y=300,OpenLayers.Util.extend(OpenLayers.Layer.Grid.prototype,{getGridBounds:function(){var e="The getGridBounds() function is deprecated. It will be removed in 3.0. Please use getTilesBounds() instead.";return OpenLayers.Console.warn(e),this.getTilesBounds()}}),OpenLayers.Util.extend(OpenLayers.Format.XML.prototype,{concatChildValues:function(e,t){for(var i,n="",r=e.firstChild;r;)i=r.nodeValue,i&&(n+=i),r=r.nextSibling;return""==n&&void 0!=t&&(n=t),n}}),OpenLayers.Layer.WMS.Post=OpenLayers.Class(OpenLayers.Layer.WMS,{unsupportedBrowsers:["mozilla","firefox","opera"],SUPPORTED_TRANSITIONS:[],usePost:null,initialize:function(e,t,i,n){var r=[];r.push(e,t,i,n),OpenLayers.Layer.WMS.prototype.initialize.apply(this,r),this.usePost=-1==OpenLayers.Util.indexOf(this.unsupportedBrowsers,OpenLayers.BROWSER_NAME)},addTile:function(e,t){return new OpenLayers.Tile.Image(this,t,e,null,this.tileSize,{maxGetUrlLength:this.usePost?0:null})},CLASS_NAME:"OpenLayers.Layer.WMS.Post"}),OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:!0,initialize:function(){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.WMS.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.WMS class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.WMS.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"}),OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:!0,initialize:function(){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.MapServer.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.MapServer class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.MapServer.Untiled"}),OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(e,t,i,n){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=n,this.features=[]},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments),this.destroyAllFeatures(),this.features=null,this.url=null,this.request&&(this.request.abort(),this.request=null)},clear:function(){this.destroyAllFeatures()},draw:function(){OpenLayers.Tile.prototype.draw.apply(this,arguments)&&(this.isLoading?this.events.triggerEvent("reload"):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.loadFeaturesForRegion(this.requestSuccess))},loadFeaturesForRegion:function(e,t){this.request&&this.request.abort(),this.request=OpenLayers.Request.GET({url:this.url,success:e,failure:t,scope:this})},requestSuccess:function(e){if(this.features){var t=e.responseXML;if(t&&t.documentElement||(t=e.responseText),this.layer.vectorMode)this.layer.addFeatures(this.layer.formatObject.read(t));else{var i=new OpenLayers.Format.XML;"string"==typeof t&&(t=i.read(t));var n=i.getElementsByTagNameNS(t,"http://www.opengis.net/gml","featureMember");this.addResults(n)}}this.events&&this.events.triggerEvent("loadend"),this.request=null},addResults:function(e){for(var t=0;e.length>t;t++){var i=new this.layer.featureClass(this.layer,e[t]);this.features.push(i)}},destroyAllFeatures:function(){for(;this.features.length>0;){var e=this.features.shift();e.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"}),OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(e,t){var i=arguments,n=this.processXMLNode(t);i=[e,n.lonlat,n],OpenLayers.Feature.prototype.initialize.apply(this,i),this.createMarker(),this.layer.addMarker(this.marker)},destroy:function(){null!=this.marker&&this.layer.removeMarker(this.marker),OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(e){var t=OpenLayers.Ajax.getElementsByTagNameNS(e,"http://www.opengis.net/gml","gml","Point"),i=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(t[0],"http://www.opengis.net/gml","gml","coordinates")[0]),n=i.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(n[0]),parseFloat(n[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"}),OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:!1,tile:null,ratio:2,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature"},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:!0,encodeBBOX:!1,extractAttributes:!1,initialize:function(e,t,i,n){void 0==n&&(n={}),!n.featureClass&&OpenLayers.Layer.Vector&&OpenLayers.Feature.Vector||(this.vectorMode=!1),i=OpenLayers.Util.upperCaseObject(i),OpenLayers.Util.extend(n,{reportError:!1});var r=[];r.push(e,n),OpenLayers.Layer.Vector.prototype.initialize.apply(this,r),this.renderer&&this.vectorMode||(this.vectorMode=!1,n.featureClass||(n.featureClass=OpenLayers.Feature.WFS),OpenLayers.Layer.Markers.prototype.initialize.apply(this,r)),this.params&&this.params.typename&&!this.options.typename&&(this.options.typename=this.params.typename),this.options.geometry_column||(this.options.geometry_column="the_geom"),this.params=OpenLayers.Util.applyDefaults(i,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),this.url=t},destroy:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments):OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.tile&&this.tile.destroy(),this.tile=null,this.ratio=null,this.featureClass=null,this.format=null,this.formatObject&&this.formatObject.destroy&&this.formatObject.destroy(),this.formatObject=null,this.formatOptions=null,this.vectorMode=null,this.encodeBBOX=null,this.extractAttributes=null},setMap:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var e={extractAttributes:this.extractAttributes};OpenLayers.Util.extend(e,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(e.externalProjection=this.projection,e.internalProjection=this.map.getProjectionObject()),this.formatObject=this.format?new this.format(e):new OpenLayers.Format.GML(e)}else OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)},moveTo:function(e,t,i){if(this.vectorMode?OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments):OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),i)return!1;if(t&&this.vectorMode&&this.renderer.clear(),this.options.minZoomLevel&&(OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError")),this.map.getZoom()<this.options.minZoomLevel))return null;null==e&&(e=this.map.getExtent());var n=null==this.tile,r=!n&&!this.tile.bounds.containsBounds(e);if(t||n||!i&&r){var s=e.getCenterLonLat(),o=e.getWidth()*this.ratio,a=e.getHeight()*this.ratio,l=new OpenLayers.Bounds(s.lon-o/2,s.lat-a/2,s.lon+o/2,s.lat+a/2),h=this.map.getSize();h.w=h.w*this.ratio,h.h=h.h*this.ratio;var c=new OpenLayers.LonLat(l.left,l.top),u=this.map.getLayerPxFromLonLat(c),d=this.getFullRequestString(),p=null,f=this.params.filter||this.params.FILTER;if(p=f?{FILTER:f}:{BBOX:this.encodeBBOX?l.toBBOX():l.toArray()},this.map&&!this.projection.equals(this.map.getProjectionObject())){var m=l.clone();m.transform(this.map.getProjectionObject(),this.projection),f||(p.BBOX=this.encodeBBOX?m.toBBOX():m.toArray())}d+="&"+OpenLayers.Util.getParameterString(p),this.tile?(this.vectorMode?(this.destroyFeatures(),this.renderer.clear()):this.clearMarkers(),this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null,this.tile=new OpenLayers.Tile.WFS(this,u,l,d,h),this.addTileMonitoringHooks(this.tile),this.tile.draw()):(this.tile=new OpenLayers.Tile.WFS(this,u,l,d,h),this.addTileMonitoringHooks(this.tile),this.tile.draw())}},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this==this.layer.tile&&this.layer.events.triggerEvent("loadstart")},e.events.register("loadstart",e,e.onLoadStart),e.onLoadEnd=function(){this==this.layer.tile&&(this.layer.events.triggerEvent("tileloaded"),this.layer.events.triggerEvent("loadend"))},e.events.register("loadend",e,e.onLoadEnd),e.events.register("unload",e,e.onLoadEnd)},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,scope:e})},onMapResize:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments):OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments)},display:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.display.apply(this,arguments):OpenLayers.Layer.Markers.prototype.display.apply(this,arguments)},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),i=[t];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,i)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.getOptions())),e=this.vectorMode?OpenLayers.Layer.Vector.prototype.clone.apply(this,[e]):OpenLayers.Layer.Markers.prototype.clone.apply(this,[e])},getFullRequestString:function(){var e=this.projection.getCode()||this.map.getProjection();return this.params.SRS="none"==e?null:e,OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},commit:function(){if(!this.writer){var e={};this.map&&!this.projection.equals(this.map.getProjectionObject())&&(e.externalProjection=this.projection,e.internalProjection=this.map.getProjectionObject()),this.writer=new OpenLayers.Format.WFS(e,this)}var t=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:t,success:this.commitSuccess,failure:this.commitFailure,scope:this})},commitSuccess:function(e){var t=e.responseText;if(-1!=t.indexOf("SUCCESS")){this.commitReport(OpenLayers.i18n("commitSuccess",{response:t}));for(var i=0;this.features.length>i;i++)this.features[i].state=null}else(-1!=t.indexOf("FAILED")||-1!=t.indexOf("Exception"))&&this.commitReport(OpenLayers.i18n("commitFailed",{response:t}))},commitFailure:function(){},commitReport:function(e){OpenLayers.Console.userError(e)},refresh:function(){this.tile&&(this.vectorMode?(this.renderer.clear(),this.features.length=0):(this.clearMarkers(),this.markers.length=0),this.tile.draw())},getDataExtent:function(){var e;return e=this.vectorMode?OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this):OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this)
},setOpacity:function(e){this.vectorMode?OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[e]):OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.WFS"}),OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20],type:null,wrapDateLine:!0,sphericalMercator:!1,animationEnabled:!0,initialize:function(){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){var e=OpenLayers.Util.createDiv(this.name),t=this.map.getSize();e.style.width=t.w+"px",e.style.height=t.h+"px",this.div.appendChild(e);try{this.mapObject=new VEMap(this.name)}catch(i){}if(null!=this.mapObject){try{this.mapObject.LoadMap(null,null,this.type,!0),this.mapObject.AttachEvent("onmousedown",OpenLayers.Function.True)}catch(i){}this.mapObject.HideDashboard(),"function"==typeof this.mapObject.SetAnimationEnabled&&this.mapObject.SetAnimationEnabled(this.animationEnabled)}this.mapObject&&this.mapObject.vemapcontrol&&this.mapObject.vemapcontrol.PanMap&&"function"==typeof this.mapObject.vemapcontrol.PanMap||(this.dragPanMapObject=null)},onMapResize:function(){this.mapObject.Resize(this.map.size.w,this.map.size.h)},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"VE",layerLib:"VirtualEarth"})},setMapObjectCenter:function(e,t){this.mapObject.SetCenterAndZoom(e,t)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},dragPanMapObject:function(e,t){this.mapObject.vemapcontrol.PanMap(e,-t)},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(e){return"undefined"!=typeof VEPixel?this.mapObject.PixelToLatLong(e):this.mapObject.PixelToLatLong(e.x,e.y)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.LatLongToPixel(e)},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Longitude,e.Latitude).lon:e.Longitude},getLatitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Longitude,e.Latitude).lat:e.Latitude},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var n=this.inverseMercator(e,t);i=new VELatLong(n.lat,n.lon)}else i=new VELatLong(t,e);return i},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},getMapObjectPixelFromXY:function(e,t){return"undefined"!=typeof VEPixel?new VEPixel(e,t):new Msn.VE.Pixel(e,t)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"}),function(){if(!window.google||!google.gears){var e=null;if("undefined"!=typeof GearsFactory)e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory"),-1!=e.getBuildInfo().indexOf("ie_mobile")&&e.privateSetGlobalObject(this)}catch(t){navigator.mimeTypes!==void 0&&navigator.mimeTypes["application/x-googlegears"]&&(e=document.createElement("object"),e.style.display="none",e.width=0,e.height=0,e.type="application/x-googlegears",document.documentElement.appendChild(e))}e&&(window.google||(google={}),google.gears||(google.gears={factory:e}))}}(),OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:"ol",tableName:"ol_vector_features",postReadFiltering:!0,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e])},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this)},supported:function(){return!1},evaluateFilter:function(e,t){return t&&this.postReadFiltering?t.evaluate(e):!0},CLASS_NAME:"OpenLayers.Protocol.SQL"}),OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:"__gears_fid__",NULL_GEOMETRY:"__gears_null_geometry__",NULL_FEATURE_STATE:"__gears_null_feature_state__",jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:!0,typeOfFid:"string",db:null,initialize:function(e){this.supported()&&(OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[e]),this.jsonParser=new OpenLayers.Format.JSON,this.wktParser=new OpenLayers.Format.WKT,this.fidRegExp=RegExp("^"+this.FID_PREFIX),this.initializeDatabase())},initializeDatabase:function(){this.db=google.gears.factory.create("beta.database"),this.db.open(this.databaseName),this.db.execute("CREATE TABLE IF NOT EXISTS "+this.tableName+" (fid TEXT UNIQUE, geometry TEXT, properties TEXT,"+"  state TEXT)")},destroy:function(){this.db.close(),this.db=null,this.jsonParser=null,this.wktParser=null,OpenLayers.Protocol.SQL.prototype.destroy.apply(this)},supported:function(){return!(!window.google||!google.gears)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=OpenLayers.Util.applyDefaults(e,this.options);for(var t,i=[],n=this.db.execute("SELECT * FROM "+this.tableName);n.isValidRow();)t=this.unfreezeFeature(n),this.evaluateFilter(t,e.filter)&&(e.noFeatureStateReset||(t.state=null),i.push(t)),n.next();n.close();var r=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"read",features:i});return e&&e.callback&&e.callback.call(e.scope,r),r},unfreezeFeature:function(e){var t,i=e.fieldByName("geometry");t=i==this.NULL_GEOMETRY?new OpenLayers.Feature.Vector:this.wktParser.read(i),t.attributes=this.jsonParser.read(e.fieldByName("properties")),t.fid=this.extractFidFromField(e.fieldByName("fid"));var n=e.fieldByName("state");return n==this.NULL_FEATURE_STATE&&(n=null),t.state=n,t},extractFidFromField:function(e){return e.match(this.fidRegExp)||"number"!=this.typeOfFid||(e=parseFloat(e)),e},create:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=this.createOrUpdate(e);return i.requestType="create",t&&t.callback&&t.callback.call(t.scope,i),i},update:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=this.createOrUpdate(e);return i.requestType="update",t&&t.callback&&t.callback.call(t.scope,i),i},createOrUpdate:function(e){OpenLayers.Util.isArray(e)||(e=[e]);var t,i,n=e.length,r=Array(n);for(t=0;n>t;t++){i=e[t];var s=this.freezeFeature(i);this.db.execute("REPLACE INTO "+this.tableName+" (fid, geometry, properties, state)"+" VALUES (?, ?, ?, ?)",s);var o=i.clone();o.fid=this.extractFidFromField(s[0]),r[t]=o}return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:r,reqFeatures:e})},freezeFeature:function(e){e.fid=null!=e.fid?""+e.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var t=null!=e.geometry?""+e.geometry:this.NULL_GEOMETRY,i=this.jsonParser.write(e.attributes),n=this.getFeatureStateForFreeze(e);return[e.fid,t,i,n]},getFeatureStateForFreeze:function(e){var t;return t=this.saveFeatureState?this.createdOffline(e)?OpenLayers.State.INSERT:e.state:this.NULL_FEATURE_STATE},"delete":function(e,t){OpenLayers.Util.isArray(e)||(e=[e]),t=OpenLayers.Util.applyDefaults(t,this.options);var i,n,r;for(i=0,n=e.length;n>i;i++)if(r=e[i],this.saveFeatureState&&!this.createdOffline(r)){var s=r.clone();s.fid=r.fid,s.geometry&&(s.geometry.destroy(),s.geometry=null),s.state=r.state,this.createOrUpdate(s)}else this.db.execute("DELETE FROM "+this.tableName+" WHERE fid = ?",[r.fid]);var o=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"delete",reqFeatures:e});return t&&t.callback&&t.callback.call(t.scope,o),o},createdOffline:function(e){return"string"==typeof e.fid&&!!e.fid.match(this.fidRegExp)},commit:function(e,t){function i(e){o>++a&&(e.last=!1),this.callUserCallback(t,e)}for(var n,r,s=[],o=0,a=0,l=[],h=[],c=[],u=e.length-1;u>=0;u--)switch(r=e[u],r.state){case OpenLayers.State.INSERT:l.push(r);break;case OpenLayers.State.UPDATE:h.push(r);break;case OpenLayers.State.DELETE:c.push(r)}return l.length>0&&(o++,n=OpenLayers.Util.applyDefaults({callback:i,scope:this},t.create),s.push(this.create(l,n))),h.length>0&&(o++,n=OpenLayers.Util.applyDefaults({callback:i,scope:this},t.update),s.push(this.update(h,n))),c.length>0&&(o++,n=OpenLayers.Util.applyDefaults({callback:i,scope:this},t["delete"]),s.push(this["delete"](c,n))),s},clear:function(){this.db.execute("DELETE FROM "+this.tableName)},callUserCallback:function(e,t){var i=e[t.requestType];i&&i.callback&&i.callback.call(i.scope,t),t.last&&e.callback&&e.callback.call(e.scope)},CLASS_NAME:"OpenLayers.Protocol.SQL.Gears"}),OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20],type:null,wrapDateLine:!0,sphericalMercator:!1,initialize:function(){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){try{var e=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,e),this.mapObject.disableKeyControls(),this.mapObject.disableDragMap(),this.mapObject.moveByXY&&"function"==typeof this.mapObject.moveByXY||(this.dragPanMapObject=null)}catch(t){}},onMapResize:function(){try{var e=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(e)}catch(t){}},setMap:function(){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var e=OpenLayers.Util.getElement("ygddfdiv");null!=e&&(null!=e.parentNode&&e.parentNode.removeChild(e),this.map.events.unregister("moveend",this,this.fixYahooEventPane))},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"Yahoo",layerLib:"Yahoo"})},getOLZoomFromMapObjectZoom:function(e){var t=null;return null!=e&&(t=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[e]),t=18-t),t},getMapObjectZoomFromOLZoom:function(e){var t=null;return null!=e&&(t=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[e]),t=18-t),t},setMapObjectCenter:function(e,t){this.mapObject.drawZoomAndCenter(e,t)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},dragPanMapObject:function(e,t){this.mapObject.moveByXY({x:-e,y:t})},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(e){return this.mapObject.convertXYLatLon(e)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.convertLatLonXY(e)},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Lon,e.Lat).lon:e.Lon},getLatitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.Lon,e.Lat).lat:e.Lat},getMapObjectLonLatFromLonLat:function(e,t){var i;if(this.sphericalMercator){var n=this.inverseMercator(e,t);i=new YGeoPoint(n.lat,n.lon)}else i=new YGeoPoint(t,e);return i},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},getMapObjectPixelFromXY:function(e,t){return new YCoordPoint(e,t)},getMapObjectSizeFromOLSize:function(e){return new YSize(e.w,e.h)},CLASS_NAME:"OpenLayers.Layer.Yahoo"}),OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:!1,format:null,formatOptions:null,initialize:function(e,t,i){var n=[];n.push(e,i),OpenLayers.Layer.Vector.prototype.initialize.apply(this,n),this.url=t},setVisibility:function(){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},moveTo:function(){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},loadGML:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this}),this.loaded=!0)},setUrl:function(e){this.url=e,this.destroyFeatures(),this.loaded=!1,this.loadGML()},requestSuccess:function(e){var t=e.responseXML;t&&t.documentElement||(t=e.responseText);var i={};OpenLayers.Util.extend(i,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(i.externalProjection=this.projection,i.internalProjection=this.map.getProjectionObject());var n=this.format?new this.format(i):new OpenLayers.Format.GML(i);this.addFeatures(n.read(t)),this.events.triggerEvent("loadend")},requestFailure:function(){OpenLayers.Console.userError("Error in loading GML file "+this.url),this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"}),OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(e,t,i,n){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=e,this.y=t,this.width=i,this.height=n},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)},getLength:function(){var e=2*this.width+2*this.height;return e},getArea:function(){var e=this.width*this.height;return e},CLASS_NAME:"OpenLayers.Geometry.Rectangle"}),OpenLayers.Renderer.NG=OpenLayers.Class(OpenLayers.Renderer.Elements,{labelNodeType:null,updateDimensions:function(){var e=this.map.getExtent(),t=e.scale(3);this.setExtent(t,!0);var i=this.getResolution(),n=this.rendererRoot.parentNode,r=parseFloat(n.parentNode.style.left),s=parseFloat(n.parentNode.style.top);n.style.left=(t.left-e.left)/i-r+"px",n.style.top=(e.top-t.top)/i-s+"px"},setSize:function(){this.map.getExtent()&&this.updateDimensions()},drawFeature:function(e,t){if(null==t&&(t=e.style),e.geometry){var i=this.drawGeometry(e.geometry,t,e.id);if(i!==!1&&t.label){var n=e.geometry.getCentroid();this.drawText(e.id,t,n)}else this.removeText(e.id);return i}},drawText:function(e,t,i){var n;if("string"!=typeof e?n=e:(n=this.nodeFactory(e+this.LABEL_ID_SUFFIX,this.labelNodeType),n._featureId=e),n._style=t,n._x=i.x,n._y=i.y,t.labelXOffset||t.labelYOffset){var r=isNaN(t.labelXOffset)?0:t.labelXOffset,s=isNaN(t.labelYOffset)?0:t.labelYOffset,o=this.getResolution();i.move(r*o,s*o)}return n.parentNode!==this.textRoot&&this.textRoot.appendChild(n),n},CLASS_NAME:"OpenLayers.Renderer.NG"}),function(){var e=OpenLayers.Layer.Vector.prototype.moveTo;OpenLayers.Layer.Vector.prototype.moveTo=function(t,i,n){if(OpenLayers.Renderer.NG&&this.renderer instanceof OpenLayers.Renderer.NG){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),n||this.renderer.updateDimensions(i),!this.drawn){this.drawn=!0;for(var r,s=0,o=this.features.length;o>s;s++)this.renderer.locked=s!==o-1,r=this.features[s],this.drawFeature(r)}}else e.apply(this,arguments)};var t=OpenLayers.Layer.Vector.prototype.redraw;OpenLayers.Layer.Vector.prototype.redraw=function(){OpenLayers.Renderer.NG&&this.renderer instanceof OpenLayers.Renderer.NG&&(this.drawn=!1),t.apply(this,arguments)}}(),OpenLayers.Renderer.SVG2=OpenLayers.Class(OpenLayers.Renderer.NG,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",symbolMetrics:null,labelNodeType:"g",initialize:function(){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.symbolMetrics={})},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},updateDimensions:function(e){OpenLayers.Renderer.NG.prototype.updateDimensions.apply(this,arguments);var t=this.getResolution(),i=this.extent.getWidth(),n=this.extent.getHeight(),r=[this.extent.left,-this.extent.top,i,n].join(" ");if(this.rendererRoot.setAttributeNS(null,"viewBox",r),this.rendererRoot.setAttributeNS(null,"width",i/t),this.rendererRoot.setAttributeNS(null,"height",n/t),e===!0){var s,o,a=this.vectorRoot.childNodes;for(s=0,o=a.length;o>s;++s)this.setStyle(a[s]);var l,h=this.textRoot.childNodes;for(s=0,o=h.length;o>s;++s)l=h[s],this.drawText(l,l._style,new OpenLayers.Geometry.Point(l._x,l._y))}},getNodeType:function(e,t){var i=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i=t.externalGraphic?"image":this.isComplexSymbol(t.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":i="rect";break;case"OpenLayers.Geometry.LineString":i="polyline";break;case"OpenLayers.Geometry.LinearRing":i="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="path";break;default:}return i},setStyle:function(e,t,i){t=t||e._style,i=i||e._options;var n=this.getResolution(),r=e._radius,s=n;if("OpenLayers.Geometry.Point"==e._geometryClass&&r){if(e.style.visibility="",t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){if(t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var o=e.getElementsByTagName("title");if(o.length>0)o[0].firstChild.textContent=t.graphicTitle;else{var a=this.nodeFactory(null,"title");a.textContent=t.graphicTitle,e.appendChild(a)}}t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var l=t.graphicWidth||t.graphicHeight,h=t.graphicHeight||t.graphicWidth;l=l?l:2*t.pointRadius,h=h?h:2*t.pointRadius,l*=n,h*=n;var c=void 0!=t.graphicXOffset?t.graphicXOffset*n:-(.5*l),u=void 0!=t.graphicYOffset?t.graphicYOffset*n:-(.5*h),d=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",e._x+c),e.setAttributeNS(null,"y",e._y+u),e.setAttributeNS(null,"width",l),e.setAttributeNS(null,"height",h),e.setAttributeNS(this.xlinkns,"href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+d),e.onclick=OpenLayers.Renderer.SVG2.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=3*t.pointRadius*n,f=2*p,m=this.importSymbol(t.graphicName);s=3*this.symbolMetrics[m.id].size/f*n;var g=e.parentNode,y=e.nextSibling;g&&g.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(m.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",m.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",f),e.setAttributeNS(null,"height",f),e.setAttributeNS(null,"x",e._x-p),e.setAttributeNS(null,"y",e._y-p),y?g.insertBefore(e,y):g&&g.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius*n);var v=t.rotation;if(void 0!==v||void 0!==e._rotation)if(e._rotation=v,v|=0,"svg"!==e.nodeName)e.setAttributeNS(null,"transform",["rotate(",v,e._x,e._y,")"].join(" "));else{var b=this.symbolMetrics[m.id];e.firstChild.setAttributeNS(null,"transform",["rotate(",v,b.x,b.y,")"].join(" "))}}return i.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),i.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*s),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,s))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),null!=t.cursor&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var i=e.strokeWidth*t,n=e.strokeDashstyle;switch(n){case"solid":return"none";case"dot":return[t,4*i].join();case"dash":return[4*i,4*i].join();case"dashdot":return[4*i,4*i,t,4*i].join();case"longdash":return[8*i,4*i].join();case"longdashdot":return[8*i,4*i,t,4*i].join();default:for(var r=OpenLayers.String.trim(n).split(/\s+/g),s=0,o=r.length;o>s;s++)r[s]=r[s]*t;return r.join()}},createNode:function(e,t){var i=document.createElementNS(this.xmlns,e);return t&&i.setAttributeNS(null,"id",t),i},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,i){var n=t.x,r=-t.y;return e.setAttributeNS(null,"cx",n),e.setAttributeNS(null,"cy",r),e._x=n,e._y=r,e._radius=i,e},drawLineString:function(e,t){var i=this.getComponentsString(t.components);return e.setAttributeNS(null,"points",i),e},drawLinearRing:function(e,t){var i=this.getComponentsString(t.components);return e.setAttributeNS(null,"points",i),e},drawPolygon:function(e,t){for(var i,n=[],r=0,s=t.components.length;s>r;r++)n.push("M"),i=this.getComponentsString(t.components[r].components," "),n.push(i);return n.push("z"),e.setAttributeNS(null,"d",n.join(" ")),e.setAttributeNS(null,"fill-rule","evenodd"),e},drawRectangle:function(e,t){return e.setAttributeNS(null,"x",t.x),e.setAttributeNS(null,"y",-t.y),e.setAttributeNS(null,"width",t.width),e.setAttributeNS(null,"height",t.height),e},drawText:function(e,t,i){var n=OpenLayers.Renderer.NG.prototype.drawText.apply(this,arguments),r=n.firstChild||this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_text","text"),s=this.getResolution();r.setAttributeNS(null,"x",i.x/s),r.setAttributeNS(null,"y",-i.y/s),n.setAttributeNS(null,"transform","scale("+s+")"),t.fontColor&&r.setAttributeNS(null,"fill",t.fontColor),t.fontOpacity&&r.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&r.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&r.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&r.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&r.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(r.setAttributeNS(null,"pointer-events","visible"),r._featureId=e):r.setAttributeNS(null,"pointer-events","none");var o=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;r.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG2.LABEL_ALIGN[o[0]]||"middle"),OpenLayers.IS_GECKO===!0&&r.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG2.LABEL_ALIGN[o[1]]||"central");for(var a=t.label.split("\n"),l=a.length;r.childNodes.length>l;)r.removeChild(r.lastChild);for(var h=0;l>h;h++){var c=r.childNodes[h]||this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_tspan_"+h,"tspan");if(t.labelSelect===!0&&(c._featureId=e),OpenLayers.IS_GECKO===!1&&c.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG2.LABEL_VSHIFT[o[1]]||"-35%"),c.setAttribute("x",i.x/s),0==h){var u=OpenLayers.Renderer.SVG2.LABEL_VFACTOR[o[1]];null==u&&(u=-.5),c.setAttribute("dy",u*(l-1)+"em")}else c.setAttribute("dy","1em");c.textContent=""===a[h]?" ":a[h],c.parentNode||r.appendChild(c)}return r.parentNode||n.appendChild(r),n},getComponentsString:function(e,t){for(var i=e.length,n=Array(i),r=0;i>r;r++)n[r]=this.getShortString(e[r]);return n.join(t||",")},getShortString:function(e){return e.x+","+-e.y},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,i=document.getElementById(t);if(null!=i)return i;var n=OpenLayers.Renderer.symbol[e];if(!n)throw Error(e+" is not a valid symbol name");var r=this.nodeFactory(t,"symbol"),s=this.nodeFactory(null,"polygon");r.appendChild(s);for(var o,a,l=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),h=[],c=0,u=n.length;u>c;c+=2)o=n[c],a=n[c+1],l.left=Math.min(l.left,o),l.bottom=Math.min(l.bottom,a),l.right=Math.max(l.right,o),l.top=Math.max(l.top,a),h.push(o,",",a);s.setAttributeNS(null,"points",h.join(" "));var d=l.getWidth(),p=l.getHeight(),f=[l.left-d,l.bottom-p,3*d,3*p];return r.setAttributeNS(null,"viewBox",f.join(" ")),this.symbolMetrics[t]={size:Math.max(d,p),x:l.getCenterLonLat().lon,y:l.getCenterLonLat().lat},this.defs.appendChild(r),r},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var i=e.target;t=i.parentNode&&i!=this.rendererRoot?i.parentNode._featureId:void 0}return t},CLASS_NAME:"OpenLayers.Renderer.SVG2"}),OpenLayers.Renderer.SVG2.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG2.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG2.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG2.preventDefault=function(e){e.preventDefault&&e.preventDefault()};