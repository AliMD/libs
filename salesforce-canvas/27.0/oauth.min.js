(function(e){"use strict";var t=function(){function o(){t=e.cookies.get("access_token"),e.cookies.remove("access_token")}function u(t){var n=[],r;if(!e.isUndefined(t)){for(r in t)t.hasOwnProperty(r)&&n.push(r+"="+t[r]);return"?"+n.join("&")}return""}function a(){e.cookies.set("access_token",t),self.location.reload()}function f(e){var t;e=e||{},t=e.uri||"/rest/oauth2",e.params=e.params||{state:""},e.params.state=e.params.state||e.callback||window.location.pathname,e.params.display=e.params.display||"popup",t+=u(e.params),s=window.open(t,"OAuth","status=0,toolbar=0,menubar=0,resizable=0,scrollbars=1,top=50,left=50,height=500,width=680")}function l(n){if(arguments.length===0){if(!e.isNil(t))return t}else t=n;return t}function c(t){if(arguments.length===0){if(!e.isNil(n))return n;n=e.cookies.get("instance_url")}else t===null?(e.cookies.remove("instance_url"),n=null):(e.cookies.set("instance_url",t),n=t);return n}function h(t){var n,s,o,u,a;if(!e.isNil(t)){t.indexOf("#")===0&&(t=t.substr(1)),o=t.split("&");for(n=0;n<o.length;n+=1)s=o[n].split("="),u=s[0],a=decodeURIComponent(s[1]),"access_token"===u?l(a):"instance_url"===u?c(a):"target_origin"===u?i=decodeURIComponent(a):"instance_id"===u&&(r=a)}}function p(){(!s||s.closed)&&a()}function d(e){h(e),setTimeout(window.Sfdc.canvas.oauth.checkChildWindowStatus,50)}function v(){l(null)}function m(){return!e.isNil(l())}function g(){var e,t,n,r=self.location.search;if(r){r=r.substring(1),t=r.split("&");for(e=0;e<t.length;e+=1){n=t[e].split("=");if("loginUrl"===n[0])return decodeURIComponent(n[1])+"/services/oauth2/authorize"}}return"https://login.salesforce.com/services/oauth2/authorize"}function y(t){return e.isNil(t)?e.isNil(i)?(h(document.location.hash),i):i:(i=t,t)}function b(t){return e.isNil(t)?e.isNil(r)?(h(document.location.hash),r):r:(r=t,t)}function w(){return{oauthToken:l(),instanceId:b(),targetOrigin:y()}}var t,n,r,i,s;return{init:o,login:f,logout:v,loggedin:m,loginUrl:g,token:l,instance:c,client:w,checkChildWindowStatus:p,childWindowUnloadNotification:d}}();e.module("Sfdc.canvas.oauth",t),e.oauth.init()})(Sfdc.canvas)