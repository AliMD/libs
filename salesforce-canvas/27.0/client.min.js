(function(e){"use strict";var t,n="27.0",r=function(){function o(t,n){return e.isNil(t)?t:t.substring(0,4)==="http"?t:n}function u(t){var n;if(t==="*")return t;if(!e.isNil(t)){n=e.stripUrl(t),r=o(n,r);if(r)return r}return n=document.location.hash,n&&(n=decodeURIComponent(n.replace(/^#/,"")),r=o(n,r)),r}function a(t){t&&(t.status===401&&e.isArray(t.payload)&&t.payload[0].errorCode&&t.payload[0].errorCode==="INVALID_SESSION_ID"&&e.oauth.logout(),e.isFunction(i[t.seq])&&i[t.seq](t))}function f(r,o){var a,f,l;s=s>100?0:s+1,i[s]=r,a={seq:s,src:"client",clientVersion:n,parentVersion:t,body:o},l=o&&o.config&&o.config.client,f=u(e.isNil(l)?null:l.targetOrigin);if(e.isNil(f))throw"ERROR: targetOrigin was not supplied and was not found on the hash tag, this can result from a redirect or link to another page. Try setting the targetOrgin (example: targetOrigin : sr.context.environment.targetOrigin) when making an ajax request.";e.xd.post(a,f,parent)}function l(n,r){var i;if(e.isNil(n)||e.isNil(n.oauthToken))i={status:401,statusText:"Unauthorized",parentVersion:t,payload:"client or client.oauthToken not supplied"};if(e.isNil(n.instanceId)||e.isNil(n.targetOrigin))i={status:400,statusText:"Bad Request",parentVersion:t,payload:"client.instanceId or client.targetOrigin not supplied"};if(!e.isNil(i)){if(e.isFunction(r))return r(i),!1;throw i}return!0}function c(t,n){n=n||e.oauth.client();if(l(n,t)){var r=n.oauthToken;f(t,{type:"ctx",accessToken:r,config:{client:n}})}}function h(t,n){var i,s,u;if(!t)throw"PRECONDITION ERROR: url required with AJAX call";if(!n||!e.isFunction(n.success))throw"PRECONDITION ERROR: function: 'settings.success' missing.";if(!l(n.client,n.success))return;i=n.success,u={method:"GET",async:!0,contentType:"application/json",headers:{Authorization:"OAuth "+n.client.oauthToken,Accept:"application/json"},data:null},s=e.extend(u,n||{}),s.success=undefined,s.failure=undefined,s.client.targetOrigin==="*"?s.client.targetOrigin=null:r=o(s.targetOrigin,r),f(i,{type:"ajax",accessToken:p,url:t,config:s})}function p(t){return e.oauth.token(t)}function d(){return{clientVersion:n}}var r,i=[],s=0;return e.xd.receive(a,u),{ctx:c,ajax:h,token:p,version:d}}();e.module("Sfdc.canvas.client",r)})(Sfdc.canvas)