!function(e){"use strict";function t(e){return function(t){return this===t.target?e.apply(this,arguments):void 0}}var n=function(e,t){this.init(e,t)};n.prototype={constructor:n,init:function(t,n){if(this.$element=e(t),this.options=e.extend({},e.fn.modalmanager.defaults,this.$element.data(),"object"==typeof n&&n),this.stack=[],this.backdropCount=0,this.options.resize){var r,i=this;e(window).on("resize.modal",function(){r&&clearTimeout(r),r=setTimeout(function(){for(var e=0;i.stack.length>e;e++)i.stack[e].isShown&&i.stack[e].layout()},10)})}},createModal:function(t,n){e(t).modal(e.extend({manager:this},n))},appendModal:function(n){this.stack.push(n);var r=this;n.$element.on("show.modalmanager",t(function(){var t=function(){n.isShown=!0;var t=e.support.transition&&n.$element.hasClass("fade");r.$element.toggleClass("modal-open",r.hasOpenModal()).toggleClass("page-overflow",e(window).height()<r.$element.height()),n.$parent=n.$element.parent(),n.$container=r.createContainer(n),n.$element.appendTo(n.$container),r.backdrop(n,function(){n.$element.show(),t&&n.$element[0].offsetWidth,n.layout(),n.$element.addClass("in").attr("aria-hidden",!1);var i=function(){r.setFocus(),n.$element.trigger("shown")};t?n.$element.one(e.support.transition.end,i):i()})};n.options.replace?r.replace(t):t()})),n.$element.on("hidden.modalmanager",t(function(){r.backdrop(n),n.$backdrop?e.support.transition&&n.$element.hasClass("fade")?n.$backdrop.one(e.support.transition.end,function(){r.destroyModal(n)}):r.destroyModal(n):r.destroyModal(n)})),n.$element.on("destroy.modalmanager",t(function(){r.removeModal(n)}))},destroyModal:function(e){e.destroy();var t=this.hasOpenModal();this.$element.toggleClass("modal-open",t),t||this.$element.removeClass("page-overflow"),this.removeContainer(e),this.setFocus()},hasOpenModal:function(){for(var e=0;this.stack.length>e;e++)if(this.stack[e].isShown)return!0;return!1},setFocus:function(){for(var e,t=0;this.stack.length>t;t++)this.stack[t].isShown&&(e=this.stack[t]);e&&e.focus()},removeModal:function(e){e.$element.off(".modalmanager"),e.$backdrop&&this.removeBackdrop.call(e),this.stack.splice(this.getIndexOfModal(e),1)},getModalAt:function(e){return this.stack[e]},getIndexOfModal:function(e){for(var t=0;this.stack.length>t;t++)if(e===this.stack[t])return t},replace:function(n){for(var r,i=0;this.stack.length>i;i++)this.stack[i].isShown&&(r=this.stack[i]);r?(this.$backdropHandle=r.$backdrop,r.$backdrop=null,n&&r.$element.one("hidden",t(e.proxy(n,this))),r.hide()):n&&n()},removeBackdrop:function(e){e.$backdrop.remove(),e.$backdrop=null},createBackdrop:function(t){var n;return this.$backdropHandle?(n=this.$backdropHandle,n.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):n=e('<div class="modal-backdrop '+t+'" />').appendTo(this.$element),n},removeContainer:function(e){e.$container.remove(),e.$container=null},createContainer:function(n){var i;return i=e('<div class="modal-scrollable">').css("z-index",r("modal",n?this.getIndexOfModal(n):this.stack.length)).appendTo(this.$element),n&&"static"!=n.options.backdrop?i.on("click.modal",t(function(){n.hide()})):n&&i.on("click.modal",t(function(){n.attention()})),i},backdrop:function(t,n){var i=t.$element.hasClass("fade")?"fade":"",o=t.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(t.isShown&&o){var a=e.support.transition&&i&&!this.$backdropHandle;t.$backdrop=this.createBackdrop(i),t.$backdrop.css("z-index",r("backdrop",this.getIndexOfModal(t))),a&&t.$backdrop[0].offsetWidth,t.$backdrop.addClass("in"),this.backdropCount+=1,a?t.$backdrop.one(e.support.transition.end,n):n()}else if(!t.isShown&&t.$backdrop){t.$backdrop.removeClass("in"),this.backdropCount-=1;var s=this;e.support.transition&&t.$element.hasClass("fade")?t.$backdrop.one(e.support.transition.end,function(){s.removeBackdrop(t)}):s.removeBackdrop(t)}else n&&n()},removeSpinner:function(){this.$spinner&&this.$spinner.remove(),this.$spinner=null,this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove(),this.$backdropHandle=null,this.removeSpinner()},loading:function(t){if(t=t||function(){},this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",e(window).height()<this.$element.height()),this.isLoading)if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var n=this;e.support.transition?this.$backdropHandle.one(e.support.transition.end,function(){n.removeLoading()}):n.removeLoading()}else t&&t(this.isLoading);else{this.$backdropHandle=this.createBackdrop("fade"),this.$backdropHandle[0].offsetWidth,this.$backdropHandle.css("z-index",r("backdrop",this.stack.length)).addClass("in");var i=e(this.options.spinner).css("z-index",r("modal",this.stack.length)).appendTo(this.$element).addClass("in");this.$spinner=e(this.createContainer()).append(i).on("click.modalmanager",e.proxy(this.loading,this)),this.isLoading=!0,e.support.transition?this.$backdropHandle.one(e.support.transition.end,t):t()}}};var r=function(){var t,n={};return function(r,i){if(t===void 0){var o=e('<div class="modal hide" />').appendTo("body"),a=e('<div class="modal-backdrop hide" />').appendTo("body");n.modal=+o.css("z-index"),n.backdrop=+a.css("z-index"),t=n.modal-n.backdrop,o.remove(),a.remove(),a=o=null}return n[r]+t*i}}();e.fn.modalmanager=function(t,r){return this.each(function(){var i=e(this),o=i.data("modalmanager");o||i.data("modalmanager",o=new n(this,t)),"string"==typeof t&&o[t].apply(o,[].concat(r))})},e.fn.modalmanager.defaults={backdropLimit:999,resize:!0,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'},e.fn.modalmanager.Constructor=n}(jQuery),!function(e){"use strict";var t=function(e,t){this.init(e,t)};t.prototype={constructor:t,init:function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote);var r="function"==typeof this.options.manager?this.options.manager.call(this):this.options.manager;r=r.appendModal?r:e(r).modalmanager().data("modalmanager"),r.appendModal(this)},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=e.Event("show");this.isShown||(this.$element.trigger(t),t.isDefaultPrevented()||(this.escape(),this.tab(),this.options.loading&&this.loading()))},hide:function(t){return t&&t.preventDefault(),t=e.Event("hide"),this.$element.trigger(t),!this.isShown||t.isDefaultPrevented()?this.isShown=!1:(this.isShown=!1,this.escape(),this.tab(),this.isLoading&&this.loading(),e(document).off("focusin.modal"),this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal(),void 0)},layout:function(){var t=this.options.height?"height":"max-height",n=this.options.height||this.options.maxHeight;if(this.options.width){this.$element.css("width",this.options.width);var r=this;this.$element.css("margin-left",function(){return/%/gi.test(r.options.width)?-(parseInt(r.options.width)/2)+"%":-(e(this).width()/2)+"px"})}else this.$element.css("width",""),this.$element.css("margin-left","");this.$element.find(".modal-body").css("overflow","").css(t,"");var i=e(window).height()-10<this.$element.height();n&&this.$element.find(".modal-body").css("overflow","auto").css(t,n),i||this.options.modalOverflow?this.$element.css("margin-top",0).addClass("modal-overflow"):this.$element.css("margin-top",0-this.$element.height()/2).removeClass("modal-overflow")},tab:function(){var t=this;this.isShown&&this.options.consumeTab?this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(n){if(n.keyCode&&9==n.keyCode){var r=e(this),i=e(this);t.$element.find("[data-tabindex]:enabled:not([readonly])").each(function(t){r=t.shiftKey?r.data("tabindex")>e(this).data("tabindex")?r=e(this):i=e(this):r.data("tabindex")<e(this).data("tabindex")?r=e(this):i=e(this)}),r[0]!==e(this)[0]?r.focus():i.focus(),n.preventDefault()}}):this.isShown||this.$element.off("keydown.tabindex.modal")},escape:function(){var e=this;this.isShown&&this.options.keyboard?(this.$element.attr("tabindex")||this.$element.attr("tabindex",-1),this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()})):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden");var e=this.options.height?"height":"max-height",t=this.options.height||this.options.maxHeight;t&&this.$element.find(".modal-body").css("overflow","").css(e,"")},removeLoading:function(){this.$loading.remove(),this.$loading=null,this.isLoading=!1},loading:function(t){t=t||function(){};var n=this.$element.hasClass("fade")?"fade":"";if(this.isLoading)if(this.isLoading&&this.$loading){this.$loading.removeClass("in");var r=this;e.support.transition&&this.$element.hasClass("fade")?this.$loading.one(e.support.transition.end,function(){r.removeLoading()}):r.removeLoading()}else t&&t(this.isLoading);else{var i=e.support.transition&&n;this.$loading=e('<div class="loading-mask '+n+'">').append(this.options.spinner).appendTo(this.$element),i&&this.$loading[0].offsetWidth,this.$loading.addClass("in"),this.isLoading=!0,i?this.$loading.one(e.support.transition.end,t):t()}},focus:function(){var e=this.$element.find(this.options.focusOn);e=e.length?e:this.$element,e.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var e=this;setTimeout(function(){e.$element.addClass("animated").addClass(e.options.attentionAnimation)},0)}this.focus()},destroy:function(){var t=e.Event("destroy");this.$element.trigger(t),t.isDefaultPrevented()||this.teardown()},teardown:function(){return this.$parent.length?(this.$parent!==this.$element.parent()&&this.$element.appendTo(this.$parent),this.$element.off(".modal"),this.$element.removeData("modal"),this.$element.removeClass("in").attr("aria-hidden",!0),void 0):(this.$element.remove(),this.$element=null,void 0)}},e.fn.modal=function(n,r){return this.each(function(){var i=e(this),o=i.data("modal"),a=e.extend({},e.fn.modal.defaults,i.data(),"object"==typeof n&&n);o||i.data("modal",o=new t(this,a)),"string"==typeof n?o[n].apply(o,[].concat(r)):a.show&&o.show()})},e.fn.modal.defaults={keyboard:!0,backdrop:!0,loading:!1,show:!0,width:null,height:null,maxHeight:null,modalOverflow:!1,consumeTab:!0,focusOn:null,replace:!1,resize:!1,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'},e.fn.modal.Constructor=t,e(function(){e(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),o=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(o).one("hide",function(){n.focus()})})})}(window.jQuery);