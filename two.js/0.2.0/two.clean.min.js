(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;b.length>c&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})(),function(){function w(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,c=this.height=a.height;this.renderer.setSize(b,c),this.trigger(n.Events.resize,b,c)}function x(){return(window.performance&&window.performance.now?window.performance:Date).now()}var a=this,b=a.Two||{},c=Math.sin,d=Math.cos,e=Math.atan2,f=Math.sqrt,h=(Math.round,Math.abs),i=Math.PI,j=2*i,k=i/2,l=Math.pow,m={hasEventListeners:_.isFunction(a.addEventListener),bind:function(a,b,c,d){return this.hasEventListeners?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c),this},unbind:function(a,b,c,d){return this.hasEventListeners?a.removeEventListeners(b,c,!!d):a.detachEvent("on"+b,c),this}},n=a.Two=function(a){var b=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:n.Types.svg,autostart:!1});if(this.type=b.type,this.renderer=new n[this.type](this),n.Utils.setPlaying.call(this,b.autostart),this.frameCount=0,b.fullscreen){var c=_.bind(w,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),m.bind(window,"resize",c),c()}else this.renderer.setSize(b.width,b.height),this.width=b.width,this.height=b.height;this.scene=new n.Group,this.renderer.add(this.scene),n.Instances.push(this)};_.extend(n,{Array:a.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){return a.Two=b,this},Utils:{Curve:{CollinearityEpsilon:l(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},applySvgAttributes:function(a,b){return b.cap="butt",b.join="bevel",_.each(a.attributes,function(a){var d=a.nodeName;switch(d){case"transform":break;case"visibility":b.visible=!!a.nodeValue;break;case"stroke-linecap":b.cap=a.nodeValue;break;case"stroke-linejoin":b.join=a.nodeValue;break;case"stroke-miterlimit":b.miter=a.nodeValue;break;case"stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case"stroke-opacity":case"fill-opacity":b.opacity=a.nodeValue;break;case"fill":b.fill=a.nodeValue;break;case"stroke":b.stroke=a.nodeValue}}),b},read:{svg:function(){return n.Utils.read.g.apply(this,arguments)},g:function(a){var b=new n.Group;return this.add(b),_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in n.Utils.read&&(a=n.Utils.read[c].call(this,a),b.add(a))}},this),n.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var c=a.points,d=_.map(_.range(c.numberOfItems),function(a){var b=c.getItem(a);return new n.Vector(b.x,b.y)}),e=new n.Polygon(d,!b).noStroke();return n.Utils.applySvgAttributes(a,e)},polyline:function(a){return n.Utils.read.polygon(a,!0)},path:function(a){var b=a.getAttribute("d"),c=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){var b=_.map(_.compact(a.split(/m/g)),function(a,b){return 0>=b?a:"m"+a});return b[0]="M"+b[0],b}));c.length;var e=new n.Vector,f=new n.Vector,g=_.map(c,function(b){var c,d=!1,g=!1,h=_.flatten(_.map(b.match(/[a-z][^a-z]*/gi),function(a){var b,h,i,j=a[0],k=j.toLowerCase();c=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/),d=j===k;var l,m,o,p,q,r,s,t,u;switch(k){case"z":g=!0;break;case"m":case"l":h=parseFloat(c[0]),i=parseFloat(c[1]),b=new n.Vector(h,i),d&&b.addSelf(e),e.copy(b);break;case"h":case"v":var v="h"===k?"x":"y",w="x"===v?"y":"x";b=new n.Vector,b[v]=parseFloat(c[0]),b[w]=e[w],d&&(b[v]+=e[v]),e.copy(b);break;case"s":case"c":l=e.x,m=e.y,"c"===k?(o=parseFloat(c[0]),p=parseFloat(c[1]),q=parseFloat(c[2]),r=parseFloat(c[3]),s=parseFloat(c[4]),t=parseFloat(c[5])):(u=(new n.Vector).copy(e).subSelf(f),o=parseFloat(u.x),p=parseFloat(u.y),q=parseFloat(c[0]),r=parseFloat(c[1]),s=parseFloat(c[2]),t=parseFloat(c[3])),d&&(o+=l,p+=m,q+=l,r+=m,s+=l,t+=m),b=n.Utils.subdivide(l,m,o,p,q,r,s,t),e.set(s,t),f.set(q,r);break;case"t":case"q":l=e.x,m=e.y,f.isZero()?(o=l,p=m):(o=f.x,m=f.y),"q"===k?(q=parseFloat(c[0]),r=parseFloat(c[1]),s=parseFloat(c[1]),t=parseFloat(c[2])):(u=(new n.Vector).copy(e).subSelf(f),q=parseFloat(u.x),r=parseFloat(u.y),s=parseFloat(c[0]),t=parseFloat(c[1])),d&&(o+=l,p+=m,q+=l,r+=m,s+=l,t+=m),b=n.Utils.subdivide(l,m,o,p,q,r,s,t),e.set(s,t),f.set(q,r);break;case"a":throw new n.Utils.Error("not yet able to interpret Elliptical Arcs.")}return b}));_.isUndefined(h[h.length-1])&&h.pop();var i=new n.Polygon(h,g).noStroke();return n.Utils.applySvgAttributes(a,i)});return g},circle:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),f=parseFloat(a.getAttribute("r")),g=n.Resolution,h=_.map(_.range(g),function(a){var b=a/g,e=b*j,h=f*d(e),i=f*c(e);return new n.Vector(h,i)},this),i=new n.Polygon(h,!0,!0).noStroke();return i.translation.set(b,e),n.Utils.applySvgAttributes(a,i)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),f=parseFloat(a.getAttribute("rx")),g=parseFloat(a.getAttribute("ry")),h=n.Resolution,i=_.map(_.range(h),function(a){var b=a/h,e=b*j,i=f*d(e),k=g*c(e);return new n.Vector(i,k)},this),k=new n.Polygon(i,!0,!0).noStroke();return k.translation.set(b,e),n.Utils.applySvgAttributes(a,k)},rect:function(a){var b=parseFloat(a.getAttribute("x")),c=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),e=parseFloat(a.getAttribute("height")),f=d/2,g=e/2,h=[new n.Vector(f,g),new n.Vector(-f,g),new n.Vector(-f,-g),new n.Vector(f,-g)],i=new n.Polygon(h,!0).noStroke();return i.translation.set(b+f,c+g),n.Utils.applySvgAttributes(a,i)},line:function(a){var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2")),f=d-b,g=e-c,h=f/2,i=g/2,j=[new n.Vector(-h,-i),new n.Vector(h,i)],k=new n.Polygon(j).noFill();return k.translation.set(b+h,c+i),n.Utils.applySvgAttributes(a,k)}},subdivide:function(a,b,c,d,f,g,k,l,m){var s,t,o=n.Utils.Curve.CollinearityEpsilon,p=n.Utils.Curve.RecursionLimit,q=n.Utils.Curve.CuspLimit,r=n.Utils.Curve.Tolerance;if(m=m||0,m>p)return[];var u=(a+c)/2,v=(b+d)/2,w=(c+f)/2,x=(d+g)/2,y=(f+k)/2,z=(g+l)/2,A=(u+w)/2,B=(v+x)/2,C=(w+y)/2,D=(x+z)/2,E=(A+C)/2,F=(B+D)/2,G=k-a,H=l-b,I=h((c-k)*H-(d-l)*G),J=h((f-k)*H-(g-l)*G);if(m>0){if(I>o&&J>o&&r.distance*(G*G+H*H)>=(I+J)*(I+J)){if(r.angle<r.epsilon)return[new n.Vector(E,F)];var K=e(g-d,f-c);if(s=h(K-e(d-b,c-a)),t=h(e(l-g,k-f)-K),s>=i&&(s=j-s),t>=i&&(t=j-t),r.angle>s+t)return[new n.Vector(E,F)];if(0!==q){if(s>q)return[new n.Vector(c,d)];if(t>q)return[new n.Vector(f,g)]}}}else if(I>o)if(r.distance*(G*G+H*H)>=I*I){if(r.angle<r.epsilon)return[new n.Vector(E,F)];if(s=h(e(g-d,f-c)-e(d-b,c-a)),s>=i&&(s=j-s),r.angle>s)return[new n.Vector(c,d),new n.Vector(f,g)];if(0!==q&&s>q)return[new n.Vector(c,d)]}else if(J>o){if(r.distance*(G*G+H*H)>=J*J){if(r.angle<r.epsilon)return[new n.Vector(E,F)];if(s=h(e(l-g,k-f)-e(g-d,f-c)),s>=i&&(s=j-s),r.angle>s)return[new n.Vector(c,d),new n.Vector(f,g)];if(0!==q&&s>q)return[new n.Vector2(f,g)]}}else if(G=E-(a+k)/2,H=F-(b+l)/2,r.distance>=G*G+H*H)return[new n.Vector(E,F)];return n.Utils.subdivide(a,b,u,v,A,B,E,F,m+1).concat(n.Utils.subdivide(E,F,C,D,y,z,k,l,m+1))},getCurveFromPoints:function(a,b){for(var c=[],d=a.length,e=d-1,f=0;d>f;f++){var g=a[f],h={x:g.x,y:g.y};c.push(h);var i=b?v(f-1,d):Math.max(f-1,0),j=b?v(f+1,d):Math.min(f+1,e),k=a[i],l=h,m=a[j];r(k,l,m),l.u.x||l.u.y||(l.u.x=l.x,l.u.y=l.y),l.v.x||l.v.y||(l.v.x=l.x,l.v.y=l.y)}return c},getControlPoints:function(a,b,e){var m,n,f=q(a,b),g=q(e,b),h=o(a,b),j=o(e,b),l=(f+g)/2;return 1e-4>h||1e-4>j?(b.u={x:b.x,y:b.y},b.v={x:b.x,y:b.y},b):(h*=.33,j*=.33,f>g?l+=k:l-=k,m={x:b.x+d(l)*h,y:b.y+c(l)*h},l-=i,n={x:b.x+d(l)*j,y:b.y+c(l)*j},b.u=m,b.v=n,b)},angleBetween:function(a,b){var c=a.x-b.x,d=a.y-b.y;return e(d,c)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},distanceBetween:function(a,b){return f(p(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js",this.message=a}}}),n.Utils.Error.prototype=Error(),n.Utils.Error.prototype.constructor=n.Utils.Error;var o=n.Utils.distanceBetween,p=n.Utils.distanceBetweenSquared,q=n.Utils.angleBetween,r=n.Utils.getControlPoints,v=(n.Utils.getCurveFromPoints,n.Utils.solveSegmentIntersection,n.Utils.decoupleShapes,n.Utils.mod);_.extend(n.prototype,Backbone.Events,{appendTo:function(a){return a.appendChild(this.renderer.domElement),this},play:function(){return n.Utils.setPlaying.call(this,!0),this.trigger(n.Events.play)},pause:function(){return this.playing=!1,this.trigger(n.Events.pause)},update:function(){var a=!!this._lastFrame,b=x();this.frameCount++,a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3))),this._lastFrame=b;var c=this.width,d=this.height,e=this.renderer;return(c!==e.width||d!==e.height)&&e.setSize(c,d),this.trigger(n.Events.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(n.Events.render,this.frameCount)},add:function(a){var b=a;return _.isArray(a)||(b=_.toArray(arguments)),this.scene.add(b),this},makeLine:function(a,b,c,d){var e=c-a,f=d-b,g=e/2,h=f/2,i=[new n.Vector(-g,-h),new n.Vector(g,h)],j=new n.Polygon(i).noFill();return j.translation.set(a+g,b+h),this.scene.add(j),j},makeRectangle:function(a,b,c,d){var e=c/2,f=d/2,g=[new n.Vector(e,f),new n.Vector(-e,f),new n.Vector(-e,-f),new n.Vector(e,-f)],h=new n.Polygon(g,!0);return h.translation.set(a,b),this.scene.add(h),h},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,e,f){var g=n.Resolution,h=_.map(_.range(g),function(a){var b=a/g,h=b*j,i=e*d(h),k=f*c(h);return new n.Vector(i,k)},this),i=new n.Polygon(h,!0,!0);return i.translation.set(a,b),this.scene.add(i),i},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a)){c=[];for(var d=0;b>d;d+=2){var e=arguments[d];if(!_.isNumber(e))break;var f=arguments[d+1];c.push(new n.Vector(e,f))}}var g=arguments[b-1],h=new n.Polygon(c,!(_.isBoolean(g)?g:void 0),!0),i=h.getBoundingClientRect(),j=i.left+i.width/2,k=i.top+i.height/2;return _.each(h.vertices,function(a){a.x-=j,a.y-=k}),h.translation.set(j,k),this.scene.add(h),h},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a)){c=[];for(var d=0;b>d;d+=2){var e=arguments[d];if(!_.isNumber(e))break;var f=arguments[d+1];c.push(new n.Vector(e,f))}}var g=arguments[b-1],h=new n.Polygon(c,!(_.isBoolean(g)?g:void 0));return h.center(),this.scene.add(h),h},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new n.Group;return this.scene.add(c),c.add(b),c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in n.Utils.read))return null;var c=n.Utils.read[b].call(this,a);return this.add(c),c}}),function(){_.each(n.Instances,function(a){a.playing&&a.update()}),requestAnimationFrame(arguments.callee)}()}(),function(){var a=Two.Vector=function(a,b){a=a||0,b=b||0,Object.defineProperty(this,"x",{get:function(){return a},set:function(b){a=b,this.trigger("change","x")}}),Object.defineProperty(this,"y",{get:function(){return b},set:function(a){b=a,this.trigger("change","y")}})};_.extend(a,{}),_.extend(a.prototype,Backbone.Events,{set:function(a,b){return this.x=a,this.y=b,this},copy:function(a){return this.x=a.x,this.y=a.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new a(this.x,this.y)},add:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addSelf:function(a){return this.x+=a.x,this.y+=a.y,this},sub:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},subSelf:function(a){return this.x-=a.x,this.y-=a.y,this},multiplySelf:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},divideScalar:function(a){return a?(this.x/=a,this.y/=a):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return 1e-4>this.distanceTo(a)},lerp:function(a,b){var c=(a.x-this.x)*b+this.x,d=(a.y-this.y)*b+this.y;return this.set(c,d)},isZero:function(){return 1e-4>this.length()}})}(),function(){var b=(_.range(6),Math.cos),c=Math.sin,d=Math.tan,e=Two.Matrix=function(a){this.elements=new Two.Array(9);var g=a;_.isArray(g)||(g=_.toArray(arguments)),this.identity().set(g)};_.extend(e,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,b){if(3>=b.length){var c,d,e,f=b[0]||0,g=b[1]||0,h=b[2]||0,i=a;return c=i[0]*f+i[1]*g+i[2]*h,d=i[3]*f+i[4]*g+i[5]*h,e=i[6]*f+i[7]*g+i[8]*h,{x:c,y:d,z:e}}var j=a[0],k=a[1],l=a[2],m=a[3],n=a[4],o=a[5],p=a[6],q=a[7],r=a[8],s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8];return[j*s+k*v+l*y,j*t+k*w+l*z,j*u+k*x+l*A,m*s+n*v+o*y,m*t+n*w+o*z,m*u+n*x+o*A,p*s+q*v+r*y,p*t+q*w+r*z,p*u+q*x+r*A]}}),_.extend(e.prototype,{set:function(a){var g=a;return arguments.length,_.isArray(g)||(g=_.toArray(arguments)),_.each(g,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this),this},identity:function(){return this.set(e.Identity),this},multiply:function(a,b,c,d,e){var j=arguments,k=j.length;if(1>=k)return _.each(this.elements,function(b,c){this.elements[c]=b*a},this),this;if(3>=k){var l,m,n;return a=a||0,b=b||0,c=c||0,e=this.elements,l=e[0]*a+e[1]*b+e[2]*c,m=e[3]*a+e[4]*b+e[5]*c,n=e[6]*a+e[7]*b+e[8]*c,{x:l,y:m,z:n}}var o=this.elements,p=j;return A0=o[0],A1=o[1],A2=o[2],A3=o[3],A4=o[4],A5=o[5],A6=o[6],A7=o[7],A8=o[8],B0=p[0],B1=p[1],B2=p[2],B3=p[3],B4=p[4],B5=p[5],B6=p[6],B7=p[7],B8=p[8],this.elements[0]=A0*B0+A1*B3+A2*B6,this.elements[1]=A0*B1+A1*B4+A2*B7,this.elements[2]=A0*B2+A1*B5+A2*B8,this.elements[3]=A3*B0+A4*B3+A5*B6,this.elements[4]=A3*B1+A4*B4+A5*B7,this.elements[5]=A3*B2+A4*B5+A5*B8,this.elements[6]=A6*B0+A7*B3+A8*B6,this.elements[7]=A6*B1+A7*B4+A8*B7,this.elements[8]=A6*B2+A7*B5+A8*B8,this},scale:function(a,b){var c=arguments.length;return 1>=c&&(b=a),this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){var d=b(a),e=c(a);return this.multiply(d,-e,0,e,d,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){var b=d(a);return this.multiply(1,b,0,0,1,0,0,0,1)},skewY:function(a){var b=d(a);return this.multiply(1,0,0,b,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(a){var b=this.elements,c=parseFloat(b[0].toFixed(3)),d=parseFloat(b[1].toFixed(3)),e=parseFloat(b[2].toFixed(3)),f=parseFloat(b[3].toFixed(3)),g=parseFloat(b[4].toFixed(3)),h=parseFloat(b[5].toFixed(3));if(a){var i=parseFloat(b[6].toFixed(3)),j=parseFloat(b[7].toFixed(3)),k=parseFloat(b[8].toFixed(3));return[c,f,i,d,g,j,e,h,k]}return[c,f,d,g,e,h]},clone:function(){var a=this.elements[0],b=this.elements[1],c=this.elements[2],d=this.elements[3],e=this.elements[4],f=this.elements[5];return g=this.elements[6],h=this.elements[7],i=this.elements[8],new Two.Matrix(a,b,c,d,e,f,g,h,i)}})}(),function(){function e(a){var b={},e=a.id,f=a.translation,g=a.rotation,h=a.scale,i=a.stroke,j=a.linewidth,k=a.fill,l=a.opacity,m=a.visible,n=a.cap,o=a.join,p=a.miter,q=a.curved,r=a.closed,s=a.vertices;return e&&(b.id=d.Identifier+e),f&&_.isNumber(h)&&_.isNumber(g)&&(b.transform="matrix("+(""+a._matrix)+")"),i&&(b.stroke=i),k&&(b.fill=k),l&&(b["stroke-opacity"]=b["fill-opacity"]=l),b.visibility=m?"visible":"hidden",n&&(b["stroke-linecap"]=n),o&&(b["stroke-linejoin"]=o),p&&(b["stroke-miterlimit"]=p),j&&(b["stroke-width"]=j),s&&(b.d=c.toString(s,r,q)),b}function f(a,b,d,e,f){switch(b){case"matrix":b="transform",d="matrix("+(""+d)+")";break;case"visible":b="visibility",d=d?"visible":"hidden";break;case"cap":b="stroke-linecap";break;case"join":b="stroke-linejoin";break;case"miter":b="stroke-miterlimit";break;case"linewidth":b="stroke-width";break;case"vertices":b="d",d=c.toString(d,e,f);break;case"opacity":return c.setAttributes(a,{"stroke-opacity":d,"fill-opacity":d}),void 0}a.setAttribute(b,d)}function g(){var a=this.count;return this.count++,a}var a=Two.Utils.getCurveFromPoints,b=Two.Utils.mod,c={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,b){var c=a.toLowerCase(),d=document.createElementNS(this.ns,c);return"svg"===c&&(b=_.defaults(b||{},{version:this.version})),_.isObject(b)&&this.setAttributes(d,b),d},setAttributes:function(a,b){return _.each(b,function(a,b){this.setAttribute(b,a)},a),this},removeAttributes:function(a,b){return _.each(b,function(a){this.removeAttribute(a)},a),this},toString:function(c,d,e){var f=c.length,g=f-1;if(!e)return _.map(c,function(a,b){var c;return c=0>=b?"M":"L",c+=" "+a.x.toFixed(3)+" "+a.y.toFixed(3),b>=g&&d&&(c+=" Z"),c}).join(" ");var h=a(c,d);return _.map(h,function(a,c){var e,i=d?b(c-1,f):Math.max(c-1,0),j=d?b(c+1,f):Math.min(c+1,g),k=h[i],l=h[j],m=k.v.x.toFixed(3),n=k.v.y.toFixed(3),o=a.u.x.toFixed(3),p=a.u.y.toFixed(3),q=a.x.toFixed(3),r=a.y.toFixed(3);return e=0>=c?"M "+q+" "+r:"C "+m+" "+n+" "+o+" "+p+" "+q+" "+r,c>=g&&d&&(m=a.v.x.toFixed(3),n=a.v.y.toFixed(3),o=l.u.x.toFixed(3),p=l.u.y.toFixed(3),q=l.x.toFixed(3),r=l.y.toFixed(3),e+=" C "+m+" "+n+" "+o+" "+p+" "+q+" "+r,e+=" Z"),e}).join(" ")}},d=Two[Two.Types.svg]=function(){this.count=0,this.domElement=c.createElement("svg"),this.elements=[],this.domElement.style.visibility="hidden",this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(d,{Identifier:"two-"}),_.extend(d.prototype,Backbone.Events,{setSize:function(a,b){return this.width=a,this.height=b,c.setAttributes(this.domElement,{width:a,height:b}),this},add:function(a){var d=(arguments.length,a),f=this.elements,h=this.domElement;return _.isArray(a)||(d=_.map(arguments,function(a){return a})),_.each(d,function(a){var b,d,i,j=a instanceof Two.Group;_.isUndefined(a.id)&&(a.id=g.call(this)),j?(d="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),i=e(a),delete i.stroke,delete i.fill,delete i["fill-opacity"],delete i["stroke-opacity"],delete i["stroke-linecap"],delete i["stroke-linejoin"],delete i["stroke-miterlimit"],delete i["stroke-width"]):(d="path",i=e(a)),b=c.createElement(d,i),h.appendChild(b),f.push(b)},this),this},update:function(a,b,c,d,e){var g=this.elements,h=g[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){h.appendChild(g[a])});break;case Two.Properties.demotion:_.each(c,function(a){h.removeChild(g[a])});break;default:f(h,b,c,d,e)}return this},render:function(){return this.unveil(),this}})}(),function(){function h(a){var b={},c=a.id,d=a._matrix,f=a.stroke,g=a.linewidth,h=a.fill,i=a.opacity,j=a.visible,k=a.cap,l=a.join,m=a.miter,n=a.curved,o=a.closed,p=a.vertices;return c&&(b.id=c),_.isObject(d)&&(b.matrix=d.toArray()),f&&(b.stroke=f),h&&(b.fill=h),_.isNumber(i)&&(b.opacity=i),k&&(b.cap=k),l&&(b.join=l),m&&(b.miter=m),g&&(b.linewidth=g),p&&(b.commands=e.toArray(p,n,o)),b.visible=!!j,b.curved=!!n,b.closed=!!o,b}function i(a,b,c,d,f){switch(b){case"matrix":b="matrix",c=c.toArray();break;case"vertices":b="commands",a.curved=f,a.closed=d,c=e.toArray(c,a.curved,a.closed)}a[b]=c}function j(){var a=this.count;return this.count++,a}var a=Two.Utils.getCurveFromPoints,b=Two.Utils.mod,c=function(a){_.each(a,function(a,b){this[b]=a},this),this.children={}};_.extend(c.prototype,{appendChild:function(a){var b=a.parent,c=a.id;return _.isUndefined(b)||delete b.children[c],this.children[c]=a,a.parent=this,this},removeChild:function(a){return delete this.children[a.id],this},render:function(a){var b=this.matrix;return a.save(),a.transform(b[0],b[1],b[2],b[3],b[4],b[5]),_.each(this.children,function(b){b.render(a)}),a.restore(),this}});var d=function(a){_.each(a,function(a,b){this[b]=a},this)};_.extend(d.prototype,{render:function(a){var c=this.matrix,d=this.stroke,e=this.linewidth,f=this.fill,g=this.opacity,h=this.visible,i=this.cap,j=this.join,k=this.miter,l=this.curved,m=this.closed,n=this.commands,o=n.length,p=o-1;return h?(a.save(),c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),f&&(a.fillStyle=f),d&&(a.strokeStyle=d),e&&(a.lineWidth=e),k&&(a.miterLimit=k),j&&(a.lineJoin=j),i&&(a.lineCap=i),_.isNumber(g)&&(a.globalAlpha=g),a.beginPath(),_.each(n,function(c,d){var e=c.x.toFixed(3),f=c.y.toFixed(3);if(l){var g=m?b(d-1,o):Math.max(d-1,0),h=m?b(d+1,o):Math.min(d+1,p),i=n[g],j=n[h],k=i.v.x.toFixed(3),q=i.v.y.toFixed(3),r=c.u.x.toFixed(3),s=c.u.y.toFixed(3);0>=d?a.moveTo(e,f):(a.bezierCurveTo(k,q,r,s,e,f),d>=p&&m&&(k=c.v.x.toFixed(3),q=c.v.y.toFixed(3),r=j.u.x.toFixed(3),s=j.u.y.toFixed(3),e=j.x.toFixed(3),f=j.y.toFixed(3),a.bezierCurveTo(k,q,r,s,e,f)))}else 0>=d?a.moveTo(e,f):a.lineTo(e,f)}),m&&!l&&a.closePath(),a.fill(),a.stroke(),a.restore(),void 0):this}});var e={toArray:function(b,c,d){return b.length,c?a(b,d):_.map(b,function(a){return{x:a.x,y:a.y}})}},f=Two[Two.Types.canvas]=function(){this.count=0,this.domElement=document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.elements=[],this.stage=null};_.extend(f,{}),_.extend(f,{Group:c,Element:d,getStyles:h,setStyles:i,Utils:e}),_.extend(f.prototype,Backbone.Events,{setSize:function(a,b){return this.width=this.domElement.width=a,this.height=this.domElement.height=b,_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"}),this},add:function(a){var b=Object.getPrototypeOf(this);constructor=b.constructor;var d=(arguments.length,a),e=this.elements,g=(this.domElement,constructor.Group),h=constructor.Element,i=constructor.getStyles;return _.isArray(a)||(d=_.map(arguments,function(a){return a})),_.each(d,function(a){var b,d,f=a instanceof Two.Group,k=_.isNull(this.stage);_.isUndefined(a.id)&&(a.id=j.call(this)),f?(d=i.call(this,a),delete d.stroke,delete d.fill,delete d.opacity,delete d.cap,delete d.join,delete d.miter,delete d.linewidth,b=new g(d),k&&(this.stage=b,this.stage.object=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new h(i.call(this,a)),e.push(b),k||this.stage.appendChild(b)},this),this},update:function(a,b,c,d,e,f){var g=Object.getPrototypeOf(this),h=g.constructor,i=this.elements,j=i[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){j.appendChild(i[a])});break;case Two.Properties.demotion:_.each(c,function(a){j.removeChild(i[a]),this.elements[a]=null},this);break;default:h.setStyles.call(this,j,b,c,d,e,f)}return this},render:function(){return _.isNull(this.stage)?this:(this.ctx.clearRect(0,0,this.width,this.height),this.stage.render(this.ctx),this)}})}(),function(){function i(a){var b={},d=a.id,e=a._matrix,h=a.stroke,i=a.linewidth,j=a.fill,k=a.opacity,l=a.visible,m=a.cap,n=a.join,o=a.miter,p=a.curved,q=a.closed,r=a.vertices;return d&&(b.id=d),_.isObject(e)&&(b.matrix=b._matrix=e.toArray(!0),b.scale=b._scale=1),h&&(b.stroke=h),j&&(b.fill=j),_.isNumber(k)&&(b.opacity=k),m&&(b.cap=m),n&&(b.join=n),o&&(b.miter=o),i&&(b.linewidth=i),r&&(b.vertices=c(r,p,q),b.commands=b.vertices,b.rect=g.getBoundingClientRect(b.commands,b.linewidth,b.curved),b.triangles=g.getTriangles(b.rect)),b.visible=!!l,b.curved=!!p,b.closed=!!q,a instanceof Two.Polygon&&(g.updateBuffer(this.ctx,b,this.program),f.prototype.updateTexture.call(b,this.ctx)),b}function j(a,b,d,e,f,h){var i=!1;/matrix/.test(b)?(a[b]=d.toArray(!0),_.isNumber(e)&&(i=a.scale!==e,a.scale=e),a.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=d,a.rect=g.getBoundingClientRect(a.commands,a.linewidth,a.curved),a.triangles=g.getTriangles(a.rect),g.updateBuffer(this.ctx,a,this.program),i=!0):"vertices"===b?(_.isUndefined(e)||(a.closed=e),_.isUndefined(f)||(a.curved=f),h?a.commands=c(d,a.curved,a.closed):(a.vertices=c(d,a.curved,a.closed),a.commands=a.vertices),a.rect=g.getBoundingClientRect(a.vertices,a.linewidth,a.curved),a.triangles=g.getTriangles(a.rect),g.updateBuffer(this.ctx,a,this.program),i=!0):a[b]=d,i&&a.updateTexture(this.ctx)}var a=Two[Two.Types.canvas],b=Two.Matrix.Multiply,c=Two[Two.Types.canvas].Utils.toArray,d=Two.Utils.mod,e=function(b){a.Group.call(this,b)};_.extend(e.prototype,a.Group.prototype,{appendChild:function(){return a.Group.prototype.appendChild.apply(this,arguments),this.updateMatrix(),this},updateTexture:function(a){return _.each(this.children,function(b){b.updateTexture(a)}),this},updateMatrix:function(a){var c=a&&a._matrix||this.parent&&this.parent._matrix,d=a&&a._scale||this.parent&&this.parent._scale;return c?(this._matrix=b(this.matrix,c),this._scale=this.scale*d,_.each(this.children,function(a){a.updateMatrix(this)},this),this):this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var f=function(b){a.Element.call(this,b)};_.extend(f.prototype,a.Element.prototype,{updateMatrix:function(a){var c=a&&a._matrix||this.parent&&this.parent._matrix,d=a&&a._scale||this.parent&&this.parent._scale;return c?(this._matrix=b(this.matrix,c),this._scale=this.scale*d,this):this},updateTexture:function(a){return g.updateTexture(a,this),this},render:function(a,b){return this.visible&&this.opacity&&this.buffer?(a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer),a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniformMatrix3fv(b.matrix,!1,this._matrix),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6),this):this}});var g={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b,c){var d=1/0,e=-1/0,f=1/0,g=-1/0;_.each(a,function(a){var j,k,l,m,h=a.x,i=a.y;f=Math.min(i,f),d=Math.min(h,d),e=Math.max(h,e),g=Math.max(i,g),c&&(j=a.u.x,k=a.u.y,l=a.v.x,m=a.v.y,f=Math.min(k,m,f),d=Math.min(j,l,d),e=Math.max(j,l,e),g=Math.max(k,m,g))}),_.isNumber(b)&&(f-=b,d-=b,e+=b,g+=b);var h=e-d,i=g-f,j={x:Math.abs(d),y:Math.abs(f)};return{top:f,left:d,right:e,bottom:g,width:h,height:i,centroid:j}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right,e=a.bottom;return new Two.Array([c,b,d,b,c,e,c,e,d,b,d,e])},updateCanvas:function(a){var b=a.commands,c=this.canvas,e=this.ctx,f=a._scale,g=a.stroke,h=a.linewidth*f,i=a.fill,j=a.opacity,k=a.cap,l=a.join,m=a.miter,n=a.curved,o=a.closed,p=b.length,q=p-1;c.width=Math.max(Math.ceil(a.rect.width*f),1),c.height=Math.max(Math.ceil(a.rect.height*f),1);var r=a.rect.centroid,s=r.x*f,t=r.y*f;e.clearRect(0,0,c.width,c.height),i&&(e.fillStyle=i),g&&(e.strokeStyle=g),h&&(e.lineWidth=h),m&&(e.miterLimit=m),l&&(e.lineJoin=l),k&&(e.lineCap=k),_.isNumber(j)&&(e.globalAlpha=j),e.beginPath(),_.each(b,function(a,c){var g=(a.x*f+s).toFixed(3),h=(a.y*f+t).toFixed(3);if(n){var i=o?d(c-1,p):Math.max(c-1,0),j=o?d(c+1,p):Math.min(c+1,q),k=b[i],l=b[j],m=(k.v.x*f+s).toFixed(3),r=(k.v.y*f+t).toFixed(3),u=(a.u.x*f+s).toFixed(3),v=(a.u.y*f+t).toFixed(3);0>=c?e.moveTo(g,h):(e.bezierCurveTo(m,r,u,v,g,h),c>=q&&o&&(m=(a.v.x*f+s).toFixed(3),r=(a.v.y*f+t).toFixed(3),u=(l.u.x*f+s).toFixed(3),v=(l.u.y*f+t).toFixed(3),g=(l.x*f+s).toFixed(3),h=(l.y*f+t).toFixed(3),e.bezierCurveTo(m,r,u,v,g,h)))}else 0>=c?e.moveTo(g,h):e.lineTo(g,h)}),o&&!n&&e.closePath(),e.fill(),e.stroke()},updateTexture:function(a,b){this.updateCanvas(b),b.texture&&a.deleteTexture(b.texture),a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer),b.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,b.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer),b.buffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b.buffer),a.enableVertexAttribArray(c.position),a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW),_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer),b.textureCoordsBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer),a.enableVertexAttribArray(c.textureCoords),a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)}),a.linkProgram(c);var d=a.getProgramParameter(c,a.LINK_STATUS);if(!d)throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){var d=a.createShader(a[c]);a.shaderSource(d,b),a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(!e){var f=a.getShaderInfoLog(d);throw a.deleteShader(d),new Two.Utils.Error("unable to compile shader "+d+": "+f)}return d},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};g.ctx=g.canvas.getContext("2d");var h=Two[Two.Types.webgl]=function(a){this.count=0,this.domElement=document.createElement("canvas"),this.elements=[],this.stage=null;var b=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1}),c=this.ctx=this.domElement.getContext("webgl",b)||this.domElement.getContext("experimental-webgl",b);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var d=g.shaders.create(c,g.shaders.vertex,g.shaders.types.vertex),e=g.shaders.create(c,g.shaders.fragment,g.shaders.types.fragment);this.program=g.program.create(c,[d,e]),c.useProgram(this.program),this.program.position=c.getAttribLocation(this.program,"a_position"),this.program.matrix=c.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=c.getAttribLocation(this.program,"a_textureCoords"),c.disable(c.DEPTH_TEST),c.enable(c.BLEND),c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)};_.extend(h,{Group:e,Element:f,getStyles:i,setStyles:j}),_.extend(h.prototype,Backbone.Events,a.prototype,{setSize:function(b,c){a.prototype.setSize.apply(this,arguments),this.ctx.viewport(0,0,b,c);var d=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(d,b,c),this},render:function(){return _.isNull(this.stage)?this:(this.stage.render(this.ctx,this.program),this)}})}(),function(){var a=Two.Shape=function(b){this._matrix=new Two.Matrix;var c=_.debounce(_.bind(function(){var a=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",a,this.scale)
},this),0);return this._rotation="rotation",Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation=a,c()}}),this._scale="scale",Object.defineProperty(this,"scale",{get:function(){return this._scale},set:function(a){this._scale=a,c()}}),this.translation=new Two.Vector,this.rotation=0,this.scale=1,this.translation.bind(Two.Events.change,c),b?this:(a.MakeGetterSetter(this,a.Properties),this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="round",this.join="round",this.miter=1,void 0)};_.extend(a,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter"],MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]),_.each(b,function(b){var c="_"+b;Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a,this.trigger(Two.Events.change,this.id,b,a,this)}})})}}),_.extend(a.prototype,Backbone.Events,{addTo:function(a){return a.add(this),this},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},clone:function(){var b=new a;return b.translation.copy(this.translation),_.each(a.Properties,function(a){b[a]=this[a]},this),this}})}(),function(){var a=Two.Group=function(){Two.Shape.call(this,!0),delete this.stroke,delete this.fill,delete this.linewidth,delete this.opacity,delete this.cap,delete this.join,delete this.miter,a.MakeGetterSetter(this,Two.Shape.Properties),this.children={}};_.extend(a,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]),_.each(b,function(b){var c="_"+b;Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a,_.each(this.children,function(c){c[b]=a})}})})}}),_.extend(a.prototype,Two.Shape.prototype,{clone:function(b){b=b||this.parent;var c=_.map(this.children,function(a){return a.clone(b)}),d=new a;return b.add(d),d.add(c),d.translation.copy(this.translation),d.rotation=this.rotation,d.scale=this.scale,d},center:function(){var a=this.getBoundingClientRect();return a.centroid={x:a.left+a.width/2,y:a.top+a.height/2},_.each(this.children,function(b){b.translation.subSelf(a.centroid)}),this.translation.copy(a.centroid),this},add:function(a){var c=(arguments.length,a),d=this.children,e=this.parent,f=[];_.isArray(a)||(c=_.toArray(arguments));var g=_.bind(function(a,b,c,d,e,f){this.trigger(Two.Events.change,a,b,c,d,e,f)},this);return _.each(c,function(a){var b=a.id,c=a.parent;_.isUndefined(b)&&(e.add(a),b=a.id),_.isUndefined(d[b])&&(c&&delete c.children[b],d[b]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,g),f.push(b))},this),f.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,f),this},remove:function(a){var b=arguments.length,c=a,d=this.children,e=this.parent,f=[];return 0>=b&&e?(e.remove(this),this):(_.isArray(a)||(c=_.toArray(arguments)),_.each(c,function(a){var b=a.id;a.children,b in d&&(delete d[b],a.unbind(Two.Events.change),f.push(b))}),f.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,f),this)},getBoundingClientRect:function(){var a=1/0,b=-1/0,c=1/0,d=-1/0;_.each(this.children,function(e){var f=e.getBoundingClientRect();c&&a&&b&&d&&(c=Math.min(f.top,c),a=Math.min(f.left,a),b=Math.max(f.right,b),d=Math.max(f.bottom,d))},this);var e=this._matrix.multiply(a,c,1),f=this._matrix.multiply(b,d,1);return{top:e.y,left:e.x,right:f.x,bottom:f.y,width:f.x-e.x,height:f.y-e.y}},noFill:function(){return _.each(this.children,function(a){a.noFill()}),this},noStroke:function(){return _.each(this.children,function(a){a.noStroke()}),this}})}(),function(){var a=Math.min,b=Math.max,c=Math.round,d=Two.Polygon=function(d,e,f){Two.Shape.call(this),e=!!e,f=!!f;var g=0,h=1,i=!1,j=d.slice(0),k=_.debounce(_.bind(function(){var b,d,k,l;if(i){b=this.vertices.length,l=b-1,d=c(g*l),k=c(h*l),j.length=0;for(var m=d;k+1>m;m++){var n=this.vertices[m];j.push(new Two.Vector(n.x,n.y))}}this.trigger(Two.Events.change,this.id,"vertices",j,e,f,i),i=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return e},set:function(a){e=!!a,k()}}),Object.defineProperty(this,"curved",{get:function(){return f},set:function(a){f=!!a,k()}}),Object.defineProperty(this,"beginning",{get:function(){return g},set:function(c){g=a(b(c,0),1),i=!0,k()}}),Object.defineProperty(this,"ending",{get:function(){return h},set:function(c){h=a(b(c,0),1),i=!0,k()}}),this.vertices=d.slice(0),_.each(this.vertices,function(a){a.bind(Two.Events.change,k)},this),k()};_.extend(d.prototype,Two.Shape.prototype,{clone:function(){var a=_.map(this.vertices,function(a){return new Two.Vector(a.x,a.y)}),b=new d(a,this.closed,this.curved);return _.each(Two.Shape.Properties,function(a){b[a]=this[a]},this),b.translation.copy(this.translation),b.rotation=this.rotation,b.scale=this.scale,b},center:function(){var a=this.getBoundingClientRect();return a.centroid={x:a.left+a.width/2,y:a.top+a.height/2},_.each(this.vertices,function(b){b.subSelf(a.centroid)}),this.translation.addSelf(a.centroid),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(){var a=this.linewidth,b=1/0,c=-1/0,d=1/0,e=-1/0;_.each(this.vertices,function(a){var f=a.x,g=a.y;d=Math.min(g,d),b=Math.min(f,b),c=Math.max(f,c),e=Math.max(g,e)}),d-=a,b-=a,c+=a,e+=a;var f=this._matrix.multiply(b,d,1),g=this._matrix.multiply(c,e,1);return{top:f.y,left:f.x,right:g.x,bottom:g.y,width:g.x-f.x,height:g.y-f.y}}})}();